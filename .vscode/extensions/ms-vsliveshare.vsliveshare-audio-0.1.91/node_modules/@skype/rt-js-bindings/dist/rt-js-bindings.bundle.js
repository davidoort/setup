!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("@skype/rt-js-bindings",[],t):"object"==typeof exports?exports["@skype/rt-js-bindings"]=t():e["@skype/rt-js-bindings"]=t()}(window,function(){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=4)}([function(e,t,n){"use strict";
/*!
 *  AufLog.ts
 *  AUF
 *
 *  Created by Johan Blumenberg on 2016-12-29
 *  Copyright 2016 Microsoft. All rights reserved.
 *
 */function o(e,t){var n=0;return e.replace(/%[dixs%]/g,function(e){var o=0;if("%"!==e[o++])return"";var r=e[o++];return"%"===r?"%":"s"===r?t[n++]:"d"===r||"i"===r?t[n++]:"x"===r?t[n++].toString(16):e})}Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Trace=10]="Trace",e[e.Debug6=16]="Debug6",e[e.Debug5=18]="Debug5",e[e.Debug4=20]="Debug4",e[e.Debug3=30]="Debug3",e[e.Debug2=40]="Debug2",e[e.Debug1=50]="Debug1",e[e.Warning=60]="Warning",e[e.Error=70]="Error",e[e.Fatal=80]="Fatal",e[e.MetaData=90]="MetaData"}(t.LogLevel||(t.LogLevel={})),function(e){e[e.UseDefault=0]="UseDefault",e[e.Compress=1]="Compress",e[e.Disabled=2]="Disabled"}(t.LogFileCompression||(t.LogFileCompression={})),function(e){e[e.Raw=0]="Raw",e[e.Base64=1]="Base64"}(t.LogFileEncoding||(t.LogFileEncoding={})),function(e){e[e.Unencrypted=0]="Unencrypted",e[e.Encrypted=1]="Encrypted"}(t.LogFileEncryption||(t.LogFileEncryption={})),function(e){e[e.PEM=0]="PEM",e[e.DER=1]="DER",e[e.BER=2]="BER"}(t.CertStoreFormat||(t.CertStoreFormat={})),function(e){e[e.InsertFront=8]="InsertFront"}(t.AppenderFlags||(t.AppenderFlags={})),t.vsprintf=o,t.sprintf=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return o(e,t)}},function(e,t,n){"use strict";
/*!
 *  LogFactory.ts
 *  AUF
 *
 *  Created by Johan Blumenberg on 2016-12-29
 *  Copyright 2016 Microsoft. All rights reserved.
 *
 */var o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(0);function s(e){if(null===e)return-1;for(var t=0,n=e.length-1;n>=0;n--)t=37*t+e.charCodeAt(n)|0;var o="__auf_literal:";for(n=o.length-1;n>=0;n--)t=37*t+o.charCodeAt(n)|0;return t}!function(e){e[e.Unsafe=0]="Unsafe",e[e.Safe=1]="Safe",e[e.Inherited_Unsafe=2]="Inherited_Unsafe",e[e.Inherited_Safe=3]="Inherited_Safe",e[e.Blacklisted_Unsafe=4]="Blacklisted_Unsafe"}(r||(r={}));var a,l=function(){function e(e,t){this._level=i.LogLevel.Debug4,this._threshold=255,this._safe=r.Inherited_Unsafe,this._name=e,t&&(this._level=t.level(),this._safe=t.safe()?r.Inherited_Safe:r.Inherited_Unsafe,this._extendedInfo=t.extendedInfo())}return e.prototype.name=function(){return this._name},e.prototype.safe=function(){return this._safe===r.Safe||this._safe===r.Inherited_Safe},e.prototype.safety=function(){return this._safe},e.prototype.setSafety=function(e){this._safe=e},e.prototype.description=function(){return this._desc},e.prototype.setDescription=function(e){this._desc=e},e.prototype.level=function(){return this._level},e.prototype.setLevel=function(e){a.setLevel(this,e)},e.prototype._setLevel=function(e){this._level=e},e.prototype._setThreshold=function(e){this._threshold=e},e.prototype.isEnabled=function(e){return this._threshold<=e},e.prototype.setExtendedInfo=function(e){this._extendedInfo=e},e.prototype.extendedInfo=function(){return this._extendedInfo},e.prototype.trace=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];a.log.apply(a,[this,i.LogLevel.Trace,s(e),e].concat(t))},e.prototype.debug6=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];a.log.apply(a,[this,i.LogLevel.Debug6,s(e),e].concat(t))},e.prototype.debug5=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];a.log.apply(a,[this,i.LogLevel.Debug5,s(e),e].concat(t))},e.prototype.debug4=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];a.log.apply(a,[this,i.LogLevel.Debug4,s(e),e].concat(t))},e.prototype.debug3=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];a.log.apply(a,[this,i.LogLevel.Debug3,s(e),e].concat(t))},e.prototype.debug2=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];a.log.apply(a,[this,i.LogLevel.Debug2,s(e),e].concat(t))},e.prototype.debug1=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];a.log.apply(a,[this,i.LogLevel.Debug1,s(e),e].concat(t))},e.prototype.warn=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];a.log.apply(a,[this,i.LogLevel.Warning,s(e),e].concat(t))},e.prototype.error=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];a.log.apply(a,[this,i.LogLevel.Error,s(e),e].concat(t))},e.prototype.fatal=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];a.log.apply(a,[this,i.LogLevel.Fatal,s(e),e].concat(t))},e.prototype.meta=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];a.log.apply(a,[this,i.LogLevel.MetaData,s(e),e].concat(t))},e}(),c=function(){function e(){}return e.instance=function(){return a},e.levelToString=function(e){return e<=i.LogLevel.Trace?"TRACE":e<=i.LogLevel.Debug6?"DEBUG6":e<=i.LogLevel.Debug5?"DEBUG5":e<=i.LogLevel.Debug4?"DEBUG4":e<=i.LogLevel.Debug3?"DEBUG3":e<=i.LogLevel.Debug2?"DEBUG2":e<=i.LogLevel.Debug1?"DEBUG1":e<=i.LogLevel.Warning?"WARN":e<=i.LogLevel.Error?"ERROR":e<=i.LogLevel.Fatal?"FATAL":(i.LogLevel.MetaData,"META")},e.levelFromString=function(e){return this._levelFromString[e]||parseInt(e,10)},e}();function u(e,t){for(var n=t.name();n.length>0;){if(e[n])return e[n];var o=n.lastIndexOf(".");n=o<0?"":n.substr(0,o)}return e[""]?e[""]:i.LogLevel.Debug4}function f(e,t){var n=255;return t.forEach(function(t){var o=255;t.appender.levels()?o=Math.min(o,u(t.appender.levels(),e)):t.appender.receiveAll()||(o=Math.min(o,e.level())),n=Math.min(n,o)}),n}c._levelFromString={TRACE:i.LogLevel.Trace,DEBUG6:i.LogLevel.Debug6,DEBUG5:i.LogLevel.Debug5,DEBUG4:i.LogLevel.Debug4,DEBUG3:i.LogLevel.Debug3,DEBUG2:i.LogLevel.Debug2,DEBUG1:i.LogLevel.Debug1,WARN:i.LogLevel.Warning,ERROR:i.LogLevel.Error,FATAL:i.LogLevel.Fatal,META:i.LogLevel.MetaData},t.LogFactory=c;var p=function(e){function t(){var t=e.call(this)||this;return t._nextId=0,t._appenders=[],t._components={},t._componentBlacklist=[],t._components[""]=new l("",null),t}return o(t,e),t.prototype.toHex=function(e){return(4294967296+e).toString(16).substr(-8)},t.prototype.addAppender=function(e,t){void 0===t&&(t=0);var n=this._nextId++;return t&i.AppenderFlags.InsertFront?this._appenders.unshift({appender:e,handle:n}):this._appenders.push({appender:e,handle:n}),this.recalcComponentThresholds(),n},t.prototype.removeAppender=function(e){for(var t=0;t<this._appenders.length;t++)if(this._appenders[t].handle===e){this._appenders.splice(t,1);break}this.recalcComponentThresholds()},t.prototype.log=function(e,t,n,o){for(var r=[],i=4;i<arguments.length;i++)r[i-4]=arguments[i];try{if(e.isEnabled(t)){var s={timestamp:(new Date).getTime(),component:e,level:t};this._appenders.forEach(function(i){(function(e,t,n){return!!e.appender.receiveAll()||(e.appender.levels()?n>=u(e.appender.levels(),t):n>=t.level())})(i,e,t)&&i.appender.log(s,n,o,r)})}}catch(e){}},t.prototype.parent=function(e){for(;;){var t=e.lastIndexOf(".");if(e=t>=0?e.substr(0,t):"",this._components[e])return this._components[e]}},t.prototype.children=function(e){var t=[];for(var n in this._components)this.parent(n).name()===e&&t.push(this._components[n]);return t},t.prototype.component=function(e){if(this._components[e])return this._components[e];var t=new l(e,this.parent(e));this._components[e]=t;var n=f(t,this._appenders);return t._setThreshold(n),t},t.prototype.rootComponent=function(){return this.component("")},t.prototype.setSafetyRecursive=function(e,t){var n=this;this.children(e).forEach(function(e){e.safety()!==r.Inherited_Safe&&e.safety()!==r.Inherited_Unsafe||(e.setSafety(t),n.setSafetyRecursive(e.name(),t))})},t.prototype.declareComponentSafe=function(e,t){var n=this.component(e);-1!==this._componentBlacklist.indexOf(n.name())?n.setSafety(r.Blacklisted_Unsafe):n.setSafety(t?r.Safe:r.Unsafe),this.setSafetyRecursive(e,t?r.Inherited_Safe:r.Inherited_Unsafe)},t.prototype.declareComponentDescription=function(e,t){this.component(e).setDescription(t)},t.prototype.setExtendedInfoRecursive=function(e,t){var n=this;this.children(e).forEach(function(e){void 0===e.extendedInfo()&&(e.setExtendedInfo(t),n.setExtendedInfoRecursive(e.name(),t))})},t.prototype.declareComponentExtendedInfo=function(e,t){var n=this.component(e);n.setExtendedInfo(t),this.setExtendedInfoRecursive(n.name(),t)},t.prototype.recalcComponentThresholds=function(){for(var e in this._components){var t=this._components[e],n=f(t,this._appenders);t._setThreshold(n)}},t.prototype.setLevel=function(e,t){if(""===e.name())for(var n in this._components){(i=this._components[n])._setLevel(t);var o=f(i,this._appenders);i._setThreshold(o)}else{var r=e.name()+".";e._setLevel(t);o=f(e,this._appenders);for(var n in e._setThreshold(o),this._components){var i;if((i=this._components[n]).name().substr(0,r.length)===r){i._setLevel(t);var s=f(i,this._appenders);i._setThreshold(s)}}}},t.prototype.setComponentBlacklist=function(e){for(var t in this._componentBlacklist=e,this._components){var n=this._components[t];-1!==this._componentBlacklist.indexOf(n.name())&&n.setSafety(r.Blacklisted_Unsafe)}},t}(c);a=new p},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";
/*!
 *  Appenders.ts
 *  AUF
 *
 *  Created by Johan Blumenberg on 2016-12-29
 *  Copyright 2016 Microsoft. All rights reserved.
 *
 */var o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(0),s=n(1),a=function(){function e(e){this._formatter=e||new u}return e.prototype.formatter=function(){return this._formatter},e.prototype.receiveAll=function(){return!1},e.prototype.levels=function(){return null},e}();function l(e){return(4294967296+e).toString(16).substr(-8)}function c(e,t){return(1e12+e).toString(10).substr(-t)}t.AbstractLogAppender=a,function(e){e[e.Timestamp=1]="Timestamp",e[e.Component=4]="Component",e[e.Level=8]="Level",e[e.FullDate=32]="FullDate",e[e.LogId=64]="LogId"}(r=t.SLF_Flags||(t.SLF_Flags={}));var u=function(){function e(e){void 0===e&&(e=4294967295),this._flags=e}return e.prototype.format=function(e,t,n,o){var a="";if(this._flags&r.FullDate)a+=new Date(e.timestamp).toISOString()+" ";else if(this._flags&r.Timestamp){var u=new Date(e.timestamp);a+=c(u.getHours(),2)+":"+c(u.getMinutes(),2)+":"+c(u.getSeconds(),2)+"."+c(u.getMilliseconds(),2)+" "}return this._flags&r.LogId&&(a+="[#"+l(t)+"-"+(e.component.safe()?"S":"u")+"] "),this._flags&r.Level&&(a+="["+s.LogFactory.levelToString(e.level)+"] "),this._flags&r.Component&&(a+="["+e.component.name()+"] "),n||""===n?a+i.vsprintf(n,o):a+l(t)+": "+o.join(" ")},e}();t.StandardLogFormatter=u;var f=console,p=console.log||function(){},h=console.info||p,d=console.warn||h,g=console.error||d,v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.log=function(e,t,n,o){o=o.slice(0);var r=e.level<=i.LogLevel.Debug3?p:e.level<=i.LogLevel.Debug1?h:e.level<=i.LogLevel.Warning?d:g;if(-1===t){var s=this.formatter().format(e,t,"",[]);"string"==typeof o[0]&&(s+=o.shift()),r.apply(f,[s].concat(o))}else{for(var a=void 0,l=[];a=n.match(/\s*%@\s*$/);)n=n.substr(0,n.length-a[0].length),l.unshift(o.pop());s=this.formatter().format(e,t,n,o);r.apply(f,[s].concat(l))}},t}(a);t.ConsoleAppender=v;var _=function(){function e(e){this._chained=e}return e.prototype.log=function(e,t,n,o){this._chained.log(e,t,n,o)},e.prototype.receiveAll=function(){return this._chained.receiveAll()},e.prototype.levels=function(){return this._chained.levels()},e}();t.ChainedLogAppender=_;var m=function(e){function t(t,n){var o=e.call(this,t)||this;return o._levels=n,o}return o(t,e),t.prototype.levels=function(){return this._levels},t}(_);t.wrapAppenderWithLogLevels=function(e,t){return new m(e,t)}},function(e,t,n){"use strict";
/*!
 *  index.ts
 *  AUF
 *
 *  Created by Johan Blumenberg on 2016-12-29
 *  Copyright 2016 Microsoft. All rights reserved.
 *
 */function o(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),o(n(0)),o(n(1)),o(n(5)),o(n(3)),o(n(10))},function(e,t,n){"use strict";
/*!
 *  RootToolsManager.ts
 *  AUF
 *
 *  Created by Johan Blumenberg on 2016-12-29
 *  Copyright 2016 Microsoft. All rights reserved.
 *
 */var o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(6),i=n(1),s=n(0),a=n(3),l=i.LogFactory.instance().component("RootToolsManager");i.LogFactory.instance().declareComponentSafe("RootToolsManager",!0);var c;!function(e){e[e.InternalBuild=0]="InternalBuild",e[e.PublicBuild=1]="PublicBuild"}(c=t.BuildType||(t.BuildType={}));var u=c.InternalBuild;function f(e,t){var n=[];for(var o in e)n.push(t(o,e[o]));return n}function p(e,t,n){if(null==e)return null==t||0===t.length;if(null==t)return null==e||0===e.length;if(e.length===t.length){for(var o=0;o<e.length;o++)if(!n(e[o],t[o]))return!1;return!0}return!1}function h(e,t){return null==e?null==t:null==t?null==e:e.arg===t.arg&&e.op===t.op&&e.value===t.value}function d(e,t){return null==e?null==t||0===t.logId:null==t?null==e||0===e.logId:e.logId===t.logId&&e.name===t.name&&p(e.matchers,t.matchers,h)}function g(e,t){return null==e?null==t:null==t?null==e:e.component===t.component&&e.parsedLevel===t.level}function v(e,t){return null==e?null==t:null==t?null==e:e.component===t.component&&e.level===t.level}t.setBuildType=function(e){var t=u;return u=e,t};var _=function(e){function t(t,n,o){var r=e.call(this)||this;return r._unmetConditions=[],r._rtMan=t,r._triggerCallback=n,r._ecsConfig=o,r.resetConditions(),r}return o(t,e),t.prototype.config=function(){return this._ecsConfig},t.prototype.configEquals=function(e){return this._ecsConfig.includeUnsafe===e.includeUnsafe&&this._ecsConfig.mutualSubmissionType===e.mutualSubmissionType&&this._ecsConfig.name===e.name&&this._ecsConfig.reenableAfterTriggering===e.reenableAfterTriggering&&this._ecsConfig.experimentTarget===e.experimentTarget&&d(this._ecsConfig.resetCondition,e.resetCondition)&&p(this._ecsConfig.conditions,e.conditions,d)&&p(this._ecsConfig.filters,e.filters,v)},t.prototype.nativeConfigEquals=function(e){return this._ecsConfig.includeUnsafe===e.includeUnsafe&&this._ecsConfig.name===e.name&&this._ecsConfig.reenableAfterTriggering===e.reenableAfterTriggering&&d(this._ecsConfig.resetCondition,e.resetCondition)&&p(this._ecsConfig.conditions,e.conditions,d)&&p(this._ecsConfig.filters,e.filters,g)},t.prototype.needReset=function(e){return!this.configEquals(e)},t.prototype.resetConditions=function(){this._unmetConditions=[];for(var e=0;e<this._ecsConfig.conditions.length;e++)this._unmetConditions.push(e)},t.prototype.matcherMatches=function(e,t){if(e.arg>=t.length)return!1;var n=t[e.arg],o="string"==typeof n?e.value:parseInt(e.value,10);return"="===e.op||"=="===e.op?n===o:"!="===e.op?n!==o:"<"===e.op?n<o:"<="===e.op?n<=o:">"===e.op?n>o:">="===e.op?n>=o:"CONTAINS"===e.op.toUpperCase()&&(""+n).indexOf(e.value)>=0},t.prototype.conditionMatches=function(e,t,n){if(t!==e.logId)return!1;if(e.matchers)for(var o=0;o<e.matchers.length;o++)if(!this.matcherMatches(e.matchers[o],n))return!1;return!0},t.prototype.log=function(e,t,n,o){if(0!==this._unmetConditions.length&&e.component!==l){var r=this._ecsConfig;r.resetCondition&&this.conditionMatches(r.resetCondition,t,o)&&(l.debug4("LogTrigger %s: resetCondition met",r.name),this.resetConditions());for(var i=0;i<this._unmetConditions.length;i++){var s=this._unmetConditions[i];if(this.conditionMatches(r.conditions[s],t,o)){l.debug4("LogTrigger %s: condition %s met",r.name,r.conditions[s].name),this._unmetConditions.splice(i,1);break}}0===this._unmetConditions.length&&(l.debug1("LogTrigger %s has triggered, trying to send the log",r.name),this._triggerCallback.call(this._rtMan,r),r.reenableAfterTriggering&&this.resetConditions())}},t.prototype.receiveAll=function(){return!0},t}(a.AbstractLogAppender),m=function(e){function t(t,n,o){var r=e.call(this)||this;return r._circularBuffer=[],r._circularBufferMaxSize=0,r._onBufferOverflow=null,r._circularBuffer=[],r._circularBufferMaxSize=n,r._includeUnsafe=t,r._onBufferOverflow=o||function(){return r._circularBuffer.shift()},r}return o(t,e),t.prototype.formatMessage=function(e){for(var t=[],n=0;n<e.length;n++)"string"==typeof e[n]||"number"==typeof e[n]?t.push(e[n]):t.push(JSON.stringify(e[n]));return t},t.prototype.log=function(e,t,n,o){if((this._includeUnsafe||e.component.safe())&&!(this._circularBuffer.length>this._circularBufferMaxSize)){var r={md:e,logId:t,messages:this.formatMessage(o)};this._circularBuffer.push(r),this._circularBuffer.length>this._circularBufferMaxSize&&this._onBufferOverflow()}},t.prototype.visitReverseOrder=function(e){for(var t=this._circularBuffer.length-1;t>=0;t--){var n=this._circularBuffer[t];if(!e(n.md,n.logId,n.messages))return}},t.prototype.visitForwardOrder=function(e){for(var t=0;t<this._circularBuffer.length;t++){var n=this._circularBuffer[t];if(!e(n.md,n.logId,n.messages))return}},t.prototype.needReset=function(e,t){return e!==this._includeUnsafe||t!==this._circularBufferMaxSize},t.prototype.dumpLogBuffer=function(e,t,n){var o=this,r=new y(e.reverse),i=e.filter.map(function(e){return{component:"root"===e.component?"":e.component,parsedLevel:e.level}}),s=n||{matchedLines:0,totalLines:0};return(e.reverse?this.visitReverseOrder:this.visitForwardOrder).apply(this,[function(e,n,a){return s.totalLines++,o.filterMatches(e,n,a,i)&&(s.matchedLines++,r.log(e.component,e.timestamp,e.level,n,a)),!t||r._data.length<t}]),r.close(),r.data()},t.prototype.filterMatches=function(e,t,n,o){for(var r=0;r<o.length;r++)if((""===o[r].component||e.component.name()===o[r].component||e.component.name().substr(0,o[r].component.length)===o[r].component&&"."===e.component.name().charAt(o[r].component.length))&&e.level>=o[r].parsedLevel)return!0;return!1},t.prototype.clear=function(){this._circularBuffer=[]},t.prototype.size=function(){return this._circularBuffer.length},t.prototype.empty=function(){return 0===this.size()},t.prototype.capacity=function(){return this._circularBufferMaxSize},t}(a.AbstractLogAppender);t.CircularBuffer=m;var y=function(){function e(e){this._reverse=e,this._first=!0,this._pending=[],this._components={},this._componentCount=0,this._lastts=0,this._base64chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",this._data="ULOG2"+String.fromCharCode(33)+String.fromCharCode(32),this._data+=e?String.fromCharCode(34):String.fromCharCode(32),this._data+=String.fromCharCode(32)}return e.prototype._add8=function(e){if(this._pending.push(255&e),3===this._pending.length){var t=(this._pending[0]<<16)+(this._pending[1]<<8)+(this._pending[2]<<0),n=this._base64chars[t>>18&63]+this._base64chars[t>>12&63]+this._base64chars[t>>6&63]+this._base64chars[t>>0&63];this._data+=n,this._pending=[]}},e.prototype._add16=function(e){this._add8(e>>8&255),this._add8(e>>0&255)},e.prototype._add32=function(e){this._add8(e>>24&255),this._add8(e>>16&255),this._add8(e>>8&255),this._add8(e>>0&255)},e.prototype._add64=function(e){this._add32(e/4294967296|0),this._add32(0|e)},e.prototype._addS=function(e){for(var t=0;t<e.length;t++)this._add8(e.charCodeAt(t));this._add8(0)},e.prototype._close=function(){for(;this._pending.length;)this._add8(0)},e.prototype.log=function(e,t,n,o,r){var i=this._components[e.name()];i||(i=++this._componentCount,this._components[e.name()]=i,this._add8(2),this._add16(i),this._addS(e.name()),this._addS(""),this._addS(""),this._add8(e.safe()?1:0));var s=128;this._first&&(s|=2);var a=t-this._lastts;this._lastts=t,a>-128&&a<128&&(s|=1),this._add8(s),1&s?this._add8(a):this._add64(1e3*t),this._first&&(this._add32(1),this._add8(0),this._add16(0)),this._add16(i),this._add8(n),this._add32(o),this._add8(r.length);for(var l=0;l<r.length;l++)this._add8(8),this._addS(""+r[l]);this._first=!1},e.prototype.close=function(){this._add8(7),this._close()},e.prototype.data=function(){return this._data},e}();function b(e){return"Native"===e||"JavaScript"===e||"Mixed"===e}var L=function(){function e(){this._maxUploadSize=0,this._jsToNativeBuffer=null,this._jsToNativeBufferHandle=null,this._jsToNativeFlushTimer=null,this._jsToNativeFlushInterval=0,this._triggers={},this._defaultBuffers=[{size:2097152,level:s.LogLevel.Debug4}],this._defaultKillswitch={blacklist:[],whitelist:[]},this._defaultBlacklists={component:[],logline:[]},this._localLogLevels={},this._defaultExperimentTarget="Mixed",this._BRBCallback=null}return e.prototype.setDelegate=function(e){this._glue=e,this.registerListeners()},e.prototype.isDelegateSet=function(){return null!=this._glue},e.prototype.setNativeFunctions=function(e){this._native&&this._native.log_config.removeLogTriggerListener(this),this._native=e,this._native&&this._native.log_config.addLogTriggerListener(this)},e.prototype.applyLogLevels=function(){var e={};for(var t in this._localLogLevels)e[t]=this._localLogLevels[t];e[""]=e.root||s.LogLevel.Debug4,delete e.root;var n=f(e,function(e,t){return{component:e,level:t}});n.sort(function(e,t){return e.component.length-t.component.length}),n.forEach(function(e){return i.LogFactory.instance().component(e.component).setLevel(e.level)}),this._native&&this._native.log_config.setLogLevelConfig(n)},e.prototype.setLocalLogLevelConfig=function(e){this._localLogLevels=e,this.applyLogLevels()},e.prototype.parseMatcher=function(e){return null==e||null==e.arg||null==e.op||null==e.value?null:{arg:e.arg,op:e.op,value:e.value}},e.prototype.parseCondition=function(e){if(null==e||null==e.logId)return null;if(e.matchers&&!(e.matchers instanceof Array))return null;var t={name:e.name||function(e){return(4294967296+e).toString(16).substr(-8)}(e.logId),logId:e.logId,matchers:[]};if(e.matchers&&e.matchers.length)for(var n=0,o=e.matchers;n<o.length;n++){var r=o[n],i=this.parseMatcher(r);i&&t.matchers.push(i)}return t},e.prototype.parseFilter=function(e){return null==e||null==e.component||0===e.component.length?null:{component:e.component,level:e.level,parsedLevel:i.LogFactory.levelFromString(e.level)}},e.prototype.parseConfig=function(e,t,n){if(null==e)return null;if(!(e.conditions instanceof Array)||0==e.conditions.length)return null;if(!(e.filters instanceof Array)||0==e.filters.length)return null;if(e.resetCondition&&!this.parseCondition(e.resetCondition))return null;for(var o={name:e.name||t+"->"+n,ecsNs:t,reenableAfterTriggering:e.reenableAfterTriggering||!1,mutualSubmissionType:e.mutualSubmissionType||"",includeUnsafe:u!==c.PublicBuild&&(e.includeUnsafe||!1),experimentTarget:b(e.experimentTarget)&&e.experimentTarget||this._defaultExperimentTarget,conditions:[],resetCondition:null==e.resetCondition?e.resetCondition:this.parseCondition(e.resetCondition),filters:[]},r=0,i=e.conditions;r<i.length;r++){var s=i[r],a=this.parseCondition(s);a&&o.conditions.push(a)}for(var l=0,f=e.filters;l<f.length;l++){var p=f[l],h=this.parseFilter(p);h&&o.filters.push(h)}return 0===o.conditions.length?null:o},e.prototype.isExperimentListed=function(e,t,n,o){return!!e&&(!(!o||!e.some(function(e){return"*"===e.namespace}))||e.some(function(e){return e.namespace===t&&(e.experiment===n||"*"==e.experiment)}))},e.prototype.isExperimentAllowed=function(e,t,n){return!this.isExperimentListed(e.blacklist,t,n,!0)||this.isExperimentListed(e.whitelist,t,n,!1)},e.prototype.findTrigger=function(e,t){for(var n in e)if(e[n].configEquals(t))return n;return null},e.prototype.findTriggerByNativeConfig=function(e,t){for(var n in e)if(e[n].nativeConfigEquals(t))return n;return null},e.prototype.OnEcsChange=function(){var e=this;return null==this._glue?r.Resolved():this._glue.fetchEcsConfig("SkypeRootTools","ULBaseline").then(function(t){l.debug4("Reloading ULBaseline config - new config: %@",t),t||(l.warn("No ULBaseline config"),t={}),e._maxUploadSize=t.logUpload&&t.logUpload.maxSize||1024;var n=[],o=e._triggers;e._triggers={};var c=(t.logUpload&&t.logUpload.maxSize||1024)/100,u=t.circularBuffer&&t.circularBuffer.enabled,p=t.circularBuffer&&t.circularBuffer.buffers||e._defaultBuffers,h=t.circularBuffer&&t.circularBuffer.storeUnsafe;e._defaultExperimentTarget=b(t.defaultExperimentTarget)&&t.defaultExperimentTarget||"Mixed";var d=t.killswitch||e._defaultKillswitch,g=t.blacklists||e._defaultBlacklists;g.component.length>0&&i.LogFactory.instance().setComponentBlacklist(g.component);var v={};(t.componentLevels||[]).forEach(function(e){return v[e.component]=e.level}),function e(t,n,o){return n<t.length?o(t[n]).then(function(){return e(t,n+1,o)}):r.Resolved()}(t.configPaths||[],0,function(t){return e._glue.fetchEcsConfig(t.ns,t.key).then(function(r){var i=r instanceof Array?r:[r];l.debug4("Reloading ECS config for %s->%s - new config: %@",t.ns,t.key,i);for(var s=0,a=i;s<a.length;s++){var c=a[s];if(null!=c){var f=e.parseConfig(c,t.ns,t.key);if(null!=f)if("JavaScript"===f.experimentTarget||"Mixed"===f.experimentTarget)if(l.debug2("Parsed ECS config for %s->%s - %@",t.ns,t.key,f),e.isExperimentAllowed(d,t.ns,f.name)){l.debug2("Allowing %s->%s:%s according to killswitch",t.ns,t.key,f.name),u=!0;var p=e.findTrigger(o,f);null!=p?(l.debug2("Triggers updated, keeping trigger %s",f.name),e._triggers[p]=o[p],delete o[p]):n.push(f),f.filters&&f.filters.forEach(function(e){return v[e.component]=Math.min(v[e.component]||255,e.parsedLevel)}),f.includeUnsafe&&(h=!0)}else l.debug2("Disallowing %s->%s according to killswitch",t.ns,t.key);else l.debug4("Skipping %s->%s, targeted for %s",t.ns,t.key,f);else l.error("Failed to parse ECS config for %s->%s",t.ns,t.key)}}})}).always(function(){for(var t in e.applyLogLevels(),o)l.debug2("Triggers updated, removing trigger %s",o[t].config().name),i.LogFactory.instance().removeAppender(+t);if(n.forEach(function(t){l.debug2("Triggers updated, adding trigger %s",t.name);var n=new _(e,e._triggered,t),o=i.LogFactory.instance().addAppender(n);e._triggers[String(o)]=n}),v[""]=v.root||s.LogLevel.Debug4,delete v.root,!e._circularBuffer||u&&!e._circularBuffer.needReset(h,c)?e._circularBuffer&&(Object.keys(o).length>0||n.length>0?(l.debug2("Buffer updated, reapplying log levels, removing log levels wrapper"),i.LogFactory.instance().removeAppender(e._circularBufferHandle),e._circularBufferHandle=null):l.debug2("Buffer updated, no change")):(l.debug2("Buffer updated, removing existing buffer"),i.LogFactory.instance().removeAppender(e._circularBufferHandle),e._circularBuffer=null,e._circularBufferHandle=null),u&&(e._circularBuffer||(l.debug2("Buffer updated, adding new buffer (storeUnsafe=%d,maxSize=%s)",h,c),e._circularBuffer=new m(h,c)),null==e._circularBufferHandle&&(l.debug2("Creating log level wrapper"),e._circularBufferHandle=i.LogFactory.instance().addAppender(a.wrapAppenderWithLogLevels(e._circularBuffer,v),s.AppenderFlags.InsertFront))),e._native){var r=f(v,function(e,t){return{component:e,level:t}});r.sort(function(e,t){return e.component.length-t.component.length}),e._native.log_config.setLogBufferConfig(u,{storeUnsafe:h,buffers:p},r);var d=[];for(var g in e._triggers){var y=e._triggers[g].config();d.push({name:y.name,ecsNs:y.ecsNs,conditions:y.conditions,resetCondition:y.resetCondition,includeUnsafe:y.includeUnsafe,reenableAfterTriggering:y.reenableAfterTriggering,filters:y.filters.map(function(e){return{component:e.component,level:e.parsedLevel}}),dumpFile:!1,metadata:{}})}e._native.log_config.setLogTriggerConfig(d,{})}})})},e.prototype._send=function(e,t){null!=this._glue&&(this._glue.sendTelemetry("638b8ba2bae14e07aa5d73ddb5d5e5c5-297b8412-5df3-4a83-83c4-7b76c6c5d3f0-7104",{logTriggerName:e.name,logEcsNs:e.ecsNs,logdata:t}),l.debug4("LogSender::send, sent %d bytes",t.length))},e.prototype.triggered=function(e,t){},e.prototype.triggeredPartially=function(e,t,n,o,r){var s=this.findTriggerByNativeConfig(this._triggers,e);if(s){var a={level:t.level,component:i.LogFactory.instance().component(t.component),timestamp:t.timestamp};this._triggers[s].log(a,n,o,r)}},e.prototype.reset=function(e){var t=this.findTriggerByNativeConfig(this._triggers,e);t&&this._triggers[t].resetConditions()},e.prototype.dumpLogBuffer=function(e,t){if(this._circularBuffer){var n={matchedLines:0,totalLines:0},o=this._circularBuffer.dumpLogBuffer(e,this._maxUploadSize,n);if(l.debug4("dumpLogBuffer: dumped %d of %d lines, size of payload: %d",n.matchedLines,n.totalLines,null!=o?o.length:0),this._native){var i=r.Defer();return this._native.log_config.mergeAndDumpLogBuffer(o,e,t,function(e){return i.resolve(e)}),i.promise()}return r.Resolved(o)}return l.warn("dumpLogBuffer: no log buffer enabled"),r.Rejected()},e.prototype._triggered=function(e){var t=this,n={compression:s.LogFileCompression.Compress,encoding:s.LogFileEncoding.Base64,encryption:s.LogFileEncryption.Encrypted,maxRotations:0,maxSize:this._maxUploadSize,reverse:!0},o={includeUnsafe:e.includeUnsafe,filter:e.filters.map(function(e){return{component:e.component,level:e.parsedLevel}}),reverse:!0};this.dumpLogBuffer(o,n).then(function(n){return t._send(e,n)})},e.prototype.sendBRBEvent=function(e){try{if(l.debug2("sendBRBEvent %s",JSON.stringify(e)),null!=this._glue&&"function"==typeof this._glue.sendLoggingEventToNative){var t={eventType:"uploadBRB",mutualSubmissionType:"call",payload:e};this._glue.sendLoggingEventToNative(JSON.stringify(t),"")}}catch(e){l.error("sendBRBEvent %s: %s",e.name,e.message)}},e.prototype.setBRBCallback=function(e){l.debug2("setBRBCallback"),null!=this._glue?"function"==typeof this._glue.setNativeLoggingEventCallback?this._BRBCallback=e:l.warn("setBRBCallback: RootToolsManagerDelegate missing setNativeLoggingEventCallback method"):l.warn("setBRBCallback: RootToolsManagerDelegate is not set")},e.prototype.registerListeners=function(){var e=this;null!=this._glue&&"function"==typeof this._glue.setNativeLoggingEventCallback?this._glue.setNativeLoggingEventCallback(function(t,n){return e.handleNativeLoggingEvent(t,n)}):l.warn("registerListeners: RootToolsManagerDelegate missing setNativeLoggingEventCallback method")},e.prototype.handleNativeLoggingEvent=function(e,t){try{l.debug2("Native Log event message: %s aux: %s",e,t);var n=JSON.parse(e);if(n.eventType&&"uploadBRB"===n.eventType){if("function"!=typeof this._BRBCallback)return void l.warn("BRBCallback not set, ignoring native event");l.debug4("Sending BRB callback: %@",n.payload),this._BRBCallback(n.payload)}else n.eventType&&"jsLogFileConfiguration"===n.eventType&&this.handleLogFileConfigEvent(n)}catch(e){l.error("handleNativeLoggingEvent %s: %s",e.name,e.message)}},e.prototype.handleLogFileConfigEvent=function(e){if(e.payload){var t=e.payload;if(t.enabled){if(t.chunkSize&&t.flushInterval){var n=t.chunkSize,o=t.flushInterval;this.startJsToNativeLogging(n,o)}}else this.flushDisableJsToNativeLogging()}},e.prototype.logExternalForDDL=function(e,t){try{if(l.debug2("logExternalForDDL %s %s",e,t),null!=this._glue&&"function"==typeof this._glue.sendLoggingEventToNative){var n={eventType:"logInSClog",payload:{message:e,parameters:t}};this._glue.sendLoggingEventToNative(JSON.stringify(n),"")}else l.warn("ignoring logExternalForDDL, delegate misconfigured")}catch(e){l.error("logExternalForDDL %s: %s",e.name,e.message)}},e.prototype.startJsToNativeLogging=function(e,t){var n=this;if(this._jsToNativeBuffer){if(this._jsToNativeBuffer.capacity()===e&&this._jsToNativeFlushInterval===t)return void l.debug1("Same JS2Native settings received - doing nothing");l.debug1("Reapplying js to native settings"),this.flushDisableJsToNativeLogging()}this._jsToNativeBuffer=new m(!0,e,function(){n.onJsToNativeBufferReady(n._jsToNativeBuffer)}),this.setJsToNativeFlushTimeout(t),this._jsToNativeFlushInterval=t,this._jsToNativeBufferHandle=i.LogFactory.instance().addAppender(this._jsToNativeBuffer)},e.prototype.flushDisableJsToNativeLogging=function(){this._jsToNativeBuffer&&this.onJsToNativeBufferReady(this._jsToNativeBuffer),this.plainDisableJsToNativeLogging()},e.prototype.plainDisableJsToNativeLogging=function(){this.clearJsToNativeFlushTimeout(),this._jsToNativeBufferHandle&&(i.LogFactory.instance().removeAppender(this._jsToNativeBufferHandle),this._jsToNativeBufferHandle=0,this._jsToNativeBuffer=null,l.debug1("Disabling forwarding JS logs to native"))},e.prototype.onJsToNativeBufferReady=function(e){null!=this._glue&&"function"==typeof this._glue.sendLoggingEventToNative?(this.clearJsToNativeFlushTimeout(),this.dumpJsToNativeBuffer(e),this.setJsToNativeFlushTimeout(this._jsToNativeFlushInterval)):this.plainDisableJsToNativeLogging()},e.prototype.dumpJsToNativeBuffer=function(e){if(!e.empty()){var t=e.dumpLogBuffer({reverse:!1,filter:[{component:"root",level:0}]});e.clear();this._glue.sendLoggingEventToNative(JSON.stringify({eventType:"writeLogData"}),t)}},e.prototype.clearJsToNativeFlushTimeout=function(){this._jsToNativeFlushTimer&&(clearTimeout(this._jsToNativeFlushTimer),this._jsToNativeFlushTimer=null)},e.prototype.setJsToNativeFlushTimeout=function(e){var t=this;!this._jsToNativeFlushTimer&&e&&(this._jsToNativeFlushTimer=setTimeout(function(){t._jsToNativeFlushTimer=null,t.onJsToNativeBufferReady(t._jsToNativeBuffer)},e))},e.prototype.stopAsyncOperations=function(){this.flushDisableJsToNativeLogging()},e}();t.RootToolsManager=new L},function(e,t,n){"use strict";(function(e){function n(e){return null!==e&&void 0!==e&&"function"==typeof e.then}function o(e){return null!==e&&void 0!==e&&"function"==typeof e.cancel}function r(e,n){if(!t.config.catchExceptions)return e();try{return e()}catch(e){return n(e)}}Object.defineProperty(t,"__esModule",{value:!0}),t.config={exceptionsToConsole:!0,catchExceptions:!0,traceEnabled:!1,exceptionHandler:void 0,unhandledErrorHandler:function(e){throw e}},t.fromThenable=function(e){var t=u();return e.then(function(e){t.resolve(e)},function(e){t.reject(e)}),t.promise().thenAsync(function(e){return e})};var i,s=[],a=void 0!==e;function l(t){s.push(t),1===s.length&&(a?e(c):setTimeout(c,0))}function c(){var e=s;s=[];for(var t=0;t<e.length;t++)e[t]()}function u(){return new i.SyncTask}function f(e){return(new i.SyncTask).resolve(e).promise()}function p(e){var t=u(),r=!1;return t.onCancel(function(t){e.forEach(function(e){o(e)&&i.SyncTask.cancelOtherInternal(e,t)})}),e.forEach(function(e){n(e)?e.then(function(e){r||(r=!0,t.resolve(e))},function(e){r||(r=!0,t.reject(e))}):r||(r=!0,t.resolve(e))}),t.promise()}t.asyncCallback=l,function(e){var i=function(){function e(){this._completedSuccess=!1,this._completedFail=!1,this._traceEnabled=!1,this._cancelCallbacks=[],this._wasCanceled=!1,this._wasExplicitlyCanceled=!1,this._resolving=!1,this._storedCallbackSets=[],this._mustHandleError=!0}return e.prototype._addCallbackSet=function(t,n){var o=this,r=new e;return r.onCancel(function(e){t.wasCanceled=!0,t.cancelContext=e,o._cancelInternal(e)}),t.task=r,this._storedCallbackSets.push(t),n?this._mustHandleError=!1:r._mustHandleError=!1,this._resolving||(this._completedSuccess?this._resolveSuccesses():this._completedFail&&this._resolveFailures()),r.promise()},e.prototype.onCancel=function(e){return this._completedSuccess||this._completedFail||(this._wasCanceled?e(this._cancelContext):this._cancelCallbacks.push(e)),this},e.prototype.then=function(e,t){return this._addCallbackSet({successFunc:e,failFunc:t},!0)},e.prototype.thenAsync=function(e,t){return this._addCallbackSet({successFunc:e,failFunc:t,asyncCallback:!0},!0)},e.prototype.catch=function(e){return this._addCallbackSet({failFunc:e},!0)},e.prototype.always=function(e){return this._addCallbackSet({successFunc:e,failFunc:e},!0)},e.prototype.setTracingEnabled=function(e){return this._traceEnabled=e,this},e.prototype.finally=function(e){return this._addCallbackSet({successFunc:e,failFunc:e},!1),this},e.prototype.done=function(e){return this._addCallbackSet({successFunc:e},!1),this},e.prototype.fail=function(e){return this._addCallbackSet({failFunc:e},!1),this},e.prototype.resolve=function(e){return this._checkState(!0),this._completedSuccess=!0,this._storedResolution=e,this._cancelCallbacks=[],this._resolveSuccesses(),this},e.prototype.reject=function(t){return this._checkState(!1),this._completedFail=!0,this._storedErrResolution=t,this._cancelCallbacks=[],this._resolveFailures(),e._enforceErrorHandled(this),this},e.prototype._checkState=function(e){if(this._completedSuccess||this._completedFail){this._completeStack&&console.error(this._completeStack.message,this._completeStack.stack);var n="Failed to "+(e?"resolve":"reject")+": the task is already "+(this._completedSuccess?"resolved":"rejected");throw new Error(n)}(t.config.traceEnabled||this._traceEnabled)&&(this._completeStack=new Error("resolve"))},e._enforceErrorHandled=function(n){n._mustHandleError&&(e._rejectedTasks.push(n),e._enforceErrorHandledTimer||(e._enforceErrorHandledTimer=setTimeout(function(){e._enforceErrorHandledTimer=void 0;var n=e._rejectedTasks;e._rejectedTasks=[],n.forEach(function(e,n){e._mustHandleError&&t.config.unhandledErrorHandler(e._storedErrResolution)})},0)))},e.prototype.cancel=function(e){if(this._wasExplicitlyCanceled)throw new Error("Already Canceled");this._wasExplicitlyCanceled=!0,this._cancelInternal(e)},e.prototype._cancelInternal=function(e){var t=this;if(!this._wasCanceled){this._wasCanceled=!0,this._cancelContext=e;var n=this._cancelCallbacks;this._cancelCallbacks=[],n.length>0&&n.forEach(function(e){t._completedSuccess||t._completedFail||e(t._cancelContext)})}},e.cancelOtherInternal=function(e,t){var n=e;n._storedCallbackSets&&n._cancelInternal?n._cancelInternal(t):e.cancel(t)},e.prototype.promise=function(){return this},e.prototype._resolveSuccesses=function(){var e=this;for(this._resolving=!0;this._storedCallbackSets.length;){var t=this._storedCallbackSets;this._storedCallbackSets=[],t.forEach(function(t){t.asyncCallback?l(function(){return e._resolveSuccessCallback(t)}):e._resolveSuccessCallback(t)})}this._resolving=!1},e.prototype._resolveSuccessCallback=function(t){var i=this;t.successFunc?r(function(){var r=t.successFunc(i._storedResolution);o(r)&&(t.wasCanceled?e.cancelOtherInternal(r,t.cancelContext):t.task.onCancel(function(t){return e.cancelOtherInternal(r,t)})),n(r)?r.then(function(e){t.task.resolve(e)},function(e){t.task.reject(e)}):t.task.resolve(r)},function(e){i._handleException(e,"SyncTask caught exception in success block: "+e.toString()),t.task.reject(e)}):t.task.resolve(this._storedResolution)},e.prototype._resolveFailures=function(){var e=this;for(this._resolving=!0;this._storedCallbackSets.length;){var t=this._storedCallbackSets;this._storedCallbackSets=[],t.forEach(function(t){t.asyncCallback?l(function(){return e._resolveFailureCallback(t)}):e._resolveFailureCallback(t)})}this._resolving=!1},e.prototype._resolveFailureCallback=function(t){var i=this;t.failFunc?r(function(){var r=t.failFunc(i._storedErrResolution);o(r)&&(t.wasCanceled?e.cancelOtherInternal(r,t.cancelContext):t.task.onCancel(function(t){return e.cancelOtherInternal(r,t)})),n(r)?r.then(function(e){t.task.resolve(e)},function(e){t.task.reject(e)}):t.task.resolve(r)},function(e){i._handleException(e,"SyncTask caught exception in failure block: "+e.toString()),t.task.reject(e)}):t.task.reject(this._storedErrResolution)},e.prototype._handleException=function(e,n){t.config.exceptionsToConsole&&console.error(n),t.config.exceptionHandler&&t.config.exceptionHandler(e)},e.prototype.toEs6Promise=function(){var e=this;return new Promise(function(t,n){return e.then(t,n)})},e._rejectedTasks=[],e}();e.SyncTask=i}(i||(i={})),t.all=function(e){if(0===e.length)return f([]);var t,r=u(),s=e.length,a=Array(e.length);r.onCancel(function(t){e.forEach(function(e){o(e)&&i.SyncTask.cancelOtherInternal(e,t)})});var l=function(){0==--s&&(void 0!==t?r.reject(t):r.resolve(a))};return e.forEach(function(e,o){n(e)?e.then(function(e){a[o]=e,l()},function(e){void 0===t&&(t=void 0===e||e),l()}):(a[o]=e,l())}),r.promise()},t.Defer=u,t.Resolved=f,t.Rejected=function(e){return(new i.SyncTask).reject(e).promise()},t.race=p,t.raceTimer=function(e,t){var n=u(),o=setTimeout(function(){n.resolve({timedOut:!0})},t);return p([e.then(function(e){return clearTimeout(o),{timedOut:!1,result:e}}),n.promise()])}}).call(this,n(7).setImmediate)},function(e,t,n){(function(e){var o=void 0!==e&&e||"undefined"!=typeof self&&self||window,r=Function.prototype.apply;function i(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new i(r.call(setTimeout,o,arguments),clearTimeout)},t.setInterval=function(){return new i(r.call(setInterval,o,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(o,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},n(8),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,n(2))},function(e,t,n){(function(e,t){!function(e,n){"use strict";if(!e.setImmediate){var o,r=1,i={},s=!1,a=e.document,l=Object.getPrototypeOf&&Object.getPrototypeOf(e);l=l&&l.setTimeout?l:e,"[object process]"==={}.toString.call(e.process)?o=function(e){t.nextTick(function(){u(e)})}:function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?function(){var t="setImmediate$"+Math.random()+"$",n=function(n){n.source===e&&"string"==typeof n.data&&0===n.data.indexOf(t)&&u(+n.data.slice(t.length))};e.addEventListener?e.addEventListener("message",n,!1):e.attachEvent("onmessage",n),o=function(n){e.postMessage(t+n,"*")}}():e.MessageChannel?function(){var e=new MessageChannel;e.port1.onmessage=function(e){u(e.data)},o=function(t){e.port2.postMessage(t)}}():a&&"onreadystatechange"in a.createElement("script")?function(){var e=a.documentElement;o=function(t){var n=a.createElement("script");n.onreadystatechange=function(){u(t),n.onreadystatechange=null,e.removeChild(n),n=null},e.appendChild(n)}}():o=function(e){setTimeout(u,0,e)},l.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var s={callback:e,args:t};return i[r]=s,o(r),r++},l.clearImmediate=c}function c(e){delete i[e]}function u(e){if(s)setTimeout(u,0,e);else{var t=i[e];if(t){s=!0;try{!function(e){var t=e.callback,o=e.args;switch(o.length){case 0:t();break;case 1:t(o[0]);break;case 2:t(o[0],o[1]);break;case 3:t(o[0],o[1],o[2]);break;default:t.apply(n,o)}}(t)}finally{c(e),s=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,n(2),n(9))},function(e,t){var n,o,r=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(e){n=i}try{o="function"==typeof clearTimeout?clearTimeout:s}catch(e){o=s}}();var l,c=[],u=!1,f=-1;function p(){u&&l&&(u=!1,l.length?c=l.concat(c):f=-1,c.length&&h())}function h(){if(!u){var e=a(p);u=!0;for(var t=c.length;t;){for(l=c,c=[];++f<t;)l&&l[f].run();f=-1,t=c.length}l=null,u=!1,function(e){if(o===clearTimeout)return clearTimeout(e);if((o===s||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(e);try{o(e)}catch(t){try{return o.call(null,e)}catch(t){return o.call(this,e)}}}(e)}}function d(e,t){this.fun=e,this.array=t}function g(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new d(e,t)),1!==c.length||u||a(h)},d.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=g,r.addListener=g,r.once=g,r.off=g,r.removeListener=g,r.removeAllListeners=g,r.emit=g,r.prependListener=g,r.prependOnceListener=g,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(e,t,n){"use strict";
/*!
 *  pii.ts
 *  AUF
 *
 *  Created by Johan Blumenberg on 2017-01-16
 *  Copyright 2017 Microsoft. All rights reserved.
 *
 */Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){return e},r=!0,i=o,s={},a=0;var l,c=/^([0-9][0-9]?):([^<>\*\{\}&'\"\/\\?^`|~\s]+)$/;!function(e){e[e.MSA=1]="MSA",e[e.S4B_Bridge=2]="S4B_Bridge",e[e.PSTN=4]="PSTN",e[e.SkypeId=8]="SkypeId",e[e.Thread=19]="Thread",e[e.LegacyShortCircuit=20]="LegacyShortCircuit",e[e.OneToOneTextMessage=21]="OneToOneTextMessage",e[e.GroupTextMessage=22]="GroupTextMessage",e[e.Bot=28]="Bot",e[e.InternalSkype=48]="InternalSkype"}(l||(l={}));var u=[l.Thread,l.InternalSkype,l.Bot];t.enableAnonymization=function(e){r=e},t.useTagger=function(e){i=e||o},function(e){function t(e){return r?e?s[e]||function(e){return s[e]="u"+ ++a}(e):null:e}e.UserName=function(e){var n=t(e);return i(n)},e.Mri=function(e){var n,o=e.match(c);if(o){var r=Number(o[1]),s=o[2];n=-1!=u.indexOf(r)?e:r+":"+t(s)}else n=t(e);return i(n)},e.Omit=function(e){var t;return t=r?"number"==typeof e?19229:"string"==typeof e?e.charAt(0)+"...":null:e,i(t)}}(t.pii||(t.pii={}))}])});