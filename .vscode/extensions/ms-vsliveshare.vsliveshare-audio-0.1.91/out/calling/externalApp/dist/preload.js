!function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=83)}([function(e,t){e.exports=require("path")},,,,,function(e,t){e.exports=require("fs")},function(e,t){e.exports=require("os")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.setInjectorConfig="controlInjector:set-injector-config",e.injectRawInput="controlInjector:inject-raw-input",e.setInjectionRect="controlInjector:set-injection-rect",e.allowSingleController="controlInjector:allow-single-controller",e.setAvatar="controlInjector:set-avatar",e.quit="quit"}(t.ElectronChannels||(t.ElectronChannels={})),t.avatarBase64="iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAFIUlEQVRYR82Yf0xVZRjHv88FrrlSVMK0TFC2RJoVuLlBP5hpcK8x2qqB1ZI/NMEwRUTkXly7c4EIcgWGBkYrQzcxapN+XCBLWaZlU2wrUtqA1GopMqEhv+Q87Rw8BPde7j3v4a66f7Cx836/z+c87/s+z3tegs6f2VIWLNHt5QZgGZjDQBTKzAtkOyJqZ6CdgDYJOAsjjjfYMrv0hCIRUbx171yC9AYxJYCwRETLwHkwPmei/Q35W/7QqtUEKIMZWMoGKBWEqVrN3Y5j9DGhgkFFWkA9AvoUzJn2Dmi/Uco/acvqnOilJwR82GYzzh+cXgogbVIZ8y6uuGzs2fyTzTbobqhbwBWW8qAAGqgjUIx3/8mPYPDpIZ6S+OWujTec3VwAl66vDAgO6m0iQvTkQ2t3YPCp6533PH3uQOrQWJULoMlSXEFEqdqtfTeSmSvrd20dt6TGAcbn2tMMjLd9F1LcSSJsaMjLrFCVo4CrthXOkQL82gl0l7itDxWMPokoTC1Bo4CTmdrI0PuxatkjCJkTrJBe7+7BmR9/wafnWvSSlzryMzOUriT/WZmzd2EAcSsIfqKOuUkmPP7oYlz9sxMtHVcVeejcYDw0/wG0Xv4NOw99gq7ePjHbMVlUAE0W+/tESBFzAWS4qPAwvPfZCZdsyVndkLhCscx5t1YYUt0wI4BW+0UCFokArn4iCmvMsdh9+BiaWtrcSmfdPRWl6a/gYsdV5B2tF7EHA5fq8zPDKc6yJ9yPDD8LqQGUpCaht38AuQePeZSueyYG5uhIvLBzn2gIDLO0mEwWew4Rdomo5cwcsqZh/8cNXjeCyFhnBmZYyGwpPgKi5P8jIJhryGyxnwQhVgRQHvvRm+n48KszOHLqvEfpwtmzUL45xeNandCA0URma3EHQCGigP/GGpQ3ipzBfhCmiAImLI3A68/H4wNH04RZlLNXlPYSvr7QgpK6E6IhwMzdZLIU3ySiQGE1gIzE5XjysQg4zjSj6ovT4yzkF0heEYMb3T3IqDyqx/4OoI4aODaaWkZu9Q+gr39g9NG8++5Fc2sbimsbhYu0aqJOsa5NIpvIxfrZmCgEBU5TWp3cg2/1DSg9OWjGdCWO3ulVxMom0VFmZK3agxu/u4C6b39A2zXXr0o5u7GREUpm9bQ7pczoKdRqDy6rdUzY5tRpkgt1wdoXdfVkpVCLtjp193rqwc47Qm9PVlqd6GFBa/1zhlRfbGPpQbfLwaXNqYcF+YHZai8BsNlbLZCPUHmvJSP3nRo0d/zubbjL8+rsdWhqbnEpSe6NeLcjf2uOksG4HUULDJKhxdtxX130rxZWCcPJgryU5xSdtxMQg/ulQSmkcc+2a6NHfrO1uACg7Z4iy4U5InQe1pdV6wLUrh/JnhxkFHDl9oJAf0PAr3q7ii5i96IeGP0fdNg29YwDlP+Jt9pfNgCHfRhM3Eri1Y6CrTWq0OXDXctUi0fVqvhnaicEhM1mMA9OOwHQU1ptfTTO4TD2JMBmk8b6ub08issqmu0X4Pc9CPN9FNyjDYOv3B4eWnJ8d06388D//PqNwVVXjH+lC12/jX0L5b5GQrmej3ovaRuWiNIa8rd4LKqaroBNO0oWQRrOImANQMbJTDszhoi4mg1+hfVvZVzy5qUJUDUxZ5fNY/8huYCu9dZ1nAMzcy+IDtBtf7ujcNPIHYmGnxDgWD+TZW80QUpiwjICzQTzTCbMUIor4yYDN0HoAugbJtQ25GWe1cDjMuRvB5EylUlS6sAAAAAASUVORK5CYII=",t.ghostAvatarBase64="iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=",t.liveShareUserSettingsFileName=".vs-liveshare-settings.json",t.logDirectoryName="VSFeedbackVSRTCLogs"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(9),i=r(15),o=r(14),s=r(0),a=r(12);var c;!function(e){e[e.Critical=1]="Critical",e[e.Error=2]="Error",e[e.Warning=4]="Warning",e[e.Information=8]="Information",e[e.Verbose=16]="Verbose",e[e.Start=256]="Start",e[e.Stop=512]="Stop",e[e.Suspend=1024]="Suspend",e[e.Resume=2048]="Resume",e[e.Transfer=4096]="Transfer"}(c=t.TraceEventType||(t.TraceEventType={}));class u extends o.EventEmitter{constructor(e){super(),this.name=e}withName(e){const t=new u(e);return this.eventNames().forEach(e=>{this.listeners(e).forEach(r=>{t.on(e,r)})}),t}addTraceListener(e){this.on(u.eventEventName,e.traceEvent.bind(e)),this.on(u.lineEventName,e.writeLine.bind(e))}writeLine(e){this.emit(u.lineEventName,e)}traceEvent(e,t,r){this.emit(u.eventEventName,this.name,e,t,r)}errorEvent(e,t){this.traceEvent(c.Error,e,t)}warningEvent(e,t){this.traceEvent(c.Warning,e,t)}infoEvent(e,t){this.traceEvent(c.Information,e,t)}error(e){this.traceEvent(c.Error,0,e)}warning(e){this.traceEvent(c.Warning,0,e)}info(e){this.traceEvent(c.Information,0,e)}verbose(e){this.traceEvent(c.Verbose,0,e)}}u.lineEventName="line",u.eventEventName="event",t.TraceSource=u;var l=r(16);t.TraceSources=l.TraceSources,t.TraceEventIds=l.TraceEventIds,t.defaultTraceSource=new u("LiveShareAudio");t.TraceListener=class{traceEvent(e,t,r,n){this.filter&&!this.filter.shouldTrace(e,t,r)||this.writeEvent(e,t,r,n)}};class f{static formatEvent(e,t,r,n,o){let s;switch(r){case c.Critical:s="C";break;case c.Error:s="E";break;case c.Warning:s="W";break;case c.Information:s="I";break;case c.Verbose:s="V";break;case c.Start:s=">";break;case c.Stop:s="<";break;default:s="?"}const a=null===e?"":i(e,"yyyy-mm-dd HH:MM:ss.l ",!0);let u;return o.length>f.maxMessageLength&&(o=o.substr(0,f.maxMessageLength)+"..."),u=0!==n?`[${a}${t} ${s}] (${n}) ${o}`:`[${a}${t} ${s}] ${o}`,u}static parseEventId(e){let t=e.match(/\] \(([0-9]+)\)/);return parseInt(t&&t[1],10)||0}static IsObfuscationDisabled(e){if("boolean"==typeof f.canCollectPII)return f.canCollectPII;const t=a.readLiveShareUserSettings(e);return f.canCollectPII=!(!t||!t.canCollectPII),e.info("Can Collect PII: "+f.canCollectPII),f.canCollectPII}static formatPath(e,t){if(!e)return"<null>";if(f.IsObfuscationDisabled(t))return e;const r=d.getShortHash(s.dirname(e)),n=s.extname(e),i=d.getShortHash(s.basename(e,n)),o=e.replace("\\","/").indexOf("/");return 2===o&&":"===e[1]?`<?:${e[2]}${r}${e[2]}${i}${n}>`:0===o?`<${e[0]}${r}${e[0]}${i}${n}>`:o>0?`<${r}${e[o]}${i}${n}>`:`<${i}${n}>`}static formatMessage(e,t){return!e||f.IsObfuscationDisabled(t)?e:"string"==typeof e?d.getShortHash(e):(e.length>0&&"string"==typeof e[0]&&e[0].startsWith("ScreenScraper.getWindowList()")&&(e[0]="ScreenScraper.getWindowList() result: "+d.getShortHash(e[0])),e)}}f.maxMessageLength=5120,t.TraceFormat=f;class d{static setKey(e){d.privacyKey=new Buffer(e,"base64")}static getShortHash(e){if(!e)return"<null>";if(!d.privacyKey)return"<redacted>";const t=n.createHmac("sha256",d.privacyKey);return t.update(e),t.digest("hex").substr(0,8)}}t.Privacy=d},function(e,t){e.exports=require("crypto")},function(e,t){e.exports=require("electron")},,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(5),i=r(6),o=r(0),s=r(7);let a;t.DeferredPromise=class{constructor(){let e,t;this.promise=new Promise((r,n)=>{e=r,t=n}),this.deferredReject=t,this.deferredResolve=e}resolve(e){this.deferredResolve(e)}reject(e){this.deferredReject(e)}},t.readLiveShareUserSettings=function(e){if(a)return a;const t=o.join(i.homedir(),s.liveShareUserSettingsFileName);try{if(n.existsSync(t)){const e=n.readFileSync(t,"utf8");return a=JSON.parse(e),a}}catch(r){e.info(`Error finding user settings at: ${t} ${r.message}`)}},t.getStartOptions=function(e){const t=Buffer.from(e,"base64").toString("utf8");return JSON.parse(t)}},,function(e,t){e.exports=require("events")},function(e,t,r){var n;!function(i){"use strict";var o,s,a,c=(o=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZWN]|"[^"]*"|'[^']*'/g,s=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,a=/[^-+\dA-Z]/g,function(e,t,r,n){if(1!==arguments.length||"string"!==d(e)||/\d/.test(e)||(t=e,e=void 0),(e=e||new Date)instanceof Date||(e=new Date(e)),isNaN(e))throw TypeError("Invalid date");var i=(t=String(c.masks[t]||t||c.masks.default)).slice(0,4);"UTC:"!==i&&"GMT:"!==i||(t=t.slice(4),r=!0,"GMT:"===i&&(n=!0));var h=r?"getUTC":"get",p=e[h+"Date"](),v=e[h+"Day"](),g=e[h+"Month"](),m=e[h+"FullYear"](),y=e[h+"Hours"](),b=e[h+"Minutes"](),T=e[h+"Seconds"](),w=e[h+"Milliseconds"](),C=r?0:e.getTimezoneOffset(),E=l(e),_=f(e),S={d:p,dd:u(p),ddd:c.i18n.dayNames[v],dddd:c.i18n.dayNames[v+7],m:g+1,mm:u(g+1),mmm:c.i18n.monthNames[g],mmmm:c.i18n.monthNames[g+12],yy:String(m).slice(2),yyyy:m,h:y%12||12,hh:u(y%12||12),H:y,HH:u(y),M:b,MM:u(b),s:T,ss:u(T),l:u(w,3),L:u(Math.round(w/10)),t:y<12?c.i18n.timeNames[0]:c.i18n.timeNames[1],tt:y<12?c.i18n.timeNames[2]:c.i18n.timeNames[3],T:y<12?c.i18n.timeNames[4]:c.i18n.timeNames[5],TT:y<12?c.i18n.timeNames[6]:c.i18n.timeNames[7],Z:n?"GMT":r?"UTC":(String(e).match(s)||[""]).pop().replace(a,""),o:(C>0?"-":"+")+u(100*Math.floor(Math.abs(C)/60)+Math.abs(C)%60,4),S:["th","st","nd","rd"][p%10>3?0:(p%100-p%10!=10)*p%10],W:E,N:_};return t.replace(o,(function(e){return e in S?S[e]:e.slice(1,e.length-1)}))});function u(e,t){for(e=String(e),t=t||2;e.length<t;)e="0"+e;return e}function l(e){var t=new Date(e.getFullYear(),e.getMonth(),e.getDate());t.setDate(t.getDate()-(t.getDay()+6)%7+3);var r=new Date(t.getFullYear(),0,4);r.setDate(r.getDate()-(r.getDay()+6)%7+3);var n=t.getTimezoneOffset()-r.getTimezoneOffset();t.setHours(t.getHours()-n);var i=(t-r)/6048e5;return 1+Math.floor(i)}function f(e){var t=e.getDay();return 0===t&&(t=7),t}function d(e){return null===e?"null":void 0===e?"undefined":"object"!=typeof e?typeof e:Array.isArray(e)?"array":{}.toString.call(e).slice(8,-1).toLowerCase()}c.masks={default:"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:sso",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'",expiresHeaderFormat:"ddd, dd mmm yyyy HH:MM:ss Z"},c.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"],timeNames:["a","p","am","pm","A","P","AM","PM"]},void 0===(n=function(){return c}.call(t,r,t,e))||(e.exports=n)}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.None=0]="None",e[e.RpcListeningOnPipe=1001]="RpcListeningOnPipe",e[e.AgentLogCreated=1002]="AgentLogCreated",e[e.AgentOutput=2001]="AgentOutput"}(t.TraceEventIds||(t.TraceEventIds={})),function(e){e.ClientAudioExtension="Client.AudioExtension"}(t.TraceSources||(t.TraceSources={}))},function(e,t,r){"use strict";var n,i;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.callStarted=0]="callStarted",e[e.callDisconnected=1]="callDisconnected",e[e.muteChanged=2]="muteChanged",e[e.participantChanged=3]="participantChanged",e[e.participantsChanged=4]="participantsChanged",e[e.screenShareEnded=5]="screenShareEnded"}(t.CallChangedType||(t.CallChangedType={})),function(e){e.dispose="dispose",e.endCall="endCall",e.enumerateDevices="enumerateDevices",e.getCallInfo="getCallInfo",e.getCurrentParticipants="getCurrentParticipants",e.getDominantSpeakers="getDominantSpeakers",e.getSelectedDevices="getSelectedDevices",e.getWindowsForSharing="getWindowsForSharing",e.initializeStackEvent="initializeStackEvent",e.isMuted="isMuted",e.loadSlimCore="loadSlimCore",e.muteOrUnmute="muteOrUnmute",e.selectDevices="selectDevices",e.shareWindow="shareWindow",e.showWindow="showWindow",e.hideWindow="hideWindow",e.startAudio="startAudio",e.startOrJoinCall="startOrJoinCall",e.stopScreenSharing="stopScreenSharing"}(n=t.RequestType||(t.RequestType={})),function(e){e.callChanged="callChanged",e.electronAppReady="electronAppReady",e.trace="trace"}(i=t.NotificationType||(t.NotificationType={})),function(e){e[e.error=0]="error",e[e.info=1]="info",e[e.warning=2]="warning"}(t.TraceType||(t.TraceType={}));t.AppEvents=class{constructor(e){this.jsonRPCProxy=e}get isDisposed(){return this.jsonRPCProxy.isDisposed}on(e,t){this.jsonRPCProxy.on(e,t)}sendRequest(e){return this.jsonRPCProxy.sendRequest(e)}sendNotification(e){return this.jsonRPCProxy.sendNotification(e)}dispose(){this.jsonRPCProxy.dispose()}};t.CallChanged=class{constructor(e,t,r){this.changeType=e,this.callParticipant=t,this.callInfo=r,this.eventType=i.callChanged}};t.Dispose=class{constructor(){this.eventType=n.dispose}};t.ElectronAppReady=class{constructor(){this.eventType=i.electronAppReady}};t.EndCall=class{constructor(){this.eventType=n.endCall}};t.EnumerateDevices=class{constructor(){this.eventType=n.enumerateDevices}};t.GetCallInfo=class{constructor(){this.eventType=n.getCallInfo}};t.GetCurrentParticipants=class{constructor(){this.eventType=n.getCurrentParticipants}};t.GetDominantSpeakers=class{constructor(){this.eventType=n.getDominantSpeakers}};t.GetSelectedDevices=class{constructor(){this.eventType=n.getSelectedDevices}};t.GetWindowsForSharing=class{constructor(){this.eventType=n.getWindowsForSharing}};t.InitializeStackEvent=class{constructor(e,t){this.skypeToken=e,this.displayName=t,this.eventType=n.initializeStackEvent}};t.IsMuted=class{constructor(){this.eventType=n.isMuted}};t.LoadSlimCore=class{constructor(){this.eventType=n.loadSlimCore}};t.MuteOrUnmute=class{constructor(e,t){this.isMute=e,this.participant=t,this.eventType=n.muteOrUnmute}};t.SelectDevices=class{constructor(e){this.selectedDevices=e,this.eventType=n.selectDevices}};t.ShareWindow=class{constructor(e){this.windowId=e,this.eventType=n.shareWindow}};t.ShowWindow=class{constructor(){this.eventType=n.showWindow}};t.HideWindow=class{constructor(){this.eventType=n.hideWindow}};t.StartAudio=class{constructor(){this.eventType=n.startAudio}};t.StartOrJoinCall=class{constructor(e,t){this.groupContext=e,this.enableAudio=t,this.eventType=n.startOrJoinCall}};t.StopScreenSharing=class{constructor(){this.eventType=n.stopScreenSharing}};t.Trace=class{constructor(e,t){this.traceType=e,this.message=t,this.eventType=i.trace,"string"!=typeof t&&(this.message="")}}},,,,,,,,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=Object.prototype.toString;function i(e){return"[object String]"===n.call(e)}function o(e){return Array.isArray(e)}t.boolean=function(e){return!0===e||!1===e},t.string=i,t.number=function(e){return"[object Number]"===n.call(e)},t.error=function(e){return"[object Error]"===n.call(e)},t.func=function(e){return"[object Function]"===n.call(e)},t.array=o,t.stringArray=function(e){return o(e)&&e.every((function(e){return i(e)}))}},,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.create=function(e){return{dispose:e}}}(t.Disposable||(t.Disposable={})),function(e){var t={dispose:function(){}};e.None=function(){return t}}(t.Event||(t.Event={}));var n=function(){function e(){}return e.prototype.add=function(e,t,r){var n=this;void 0===t&&(t=null),this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(e),this._contexts.push(t),Array.isArray(r)&&r.push({dispose:function(){return n.remove(e,t)}})},e.prototype.remove=function(e,t){if(void 0===t&&(t=null),this._callbacks){for(var r=!1,n=0,i=this._callbacks.length;n<i;n++)if(this._callbacks[n]===e){if(this._contexts[n]===t)return this._callbacks.splice(n,1),void this._contexts.splice(n,1);r=!0}if(r)throw new Error("When adding a listener with a context, you should remove it with the same context")}},e.prototype.invoke=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!this._callbacks)return[];for(var r=[],n=this._callbacks.slice(0),i=this._contexts.slice(0),o=0,s=n.length;o<s;o++)try{r.push(n[o].apply(i[o],e))}catch(e){console.error(e)}return r},e.prototype.isEmpty=function(){return!this._callbacks||0===this._callbacks.length},e.prototype.dispose=function(){this._callbacks=void 0,this._contexts=void 0},e}(),i=function(){function e(e){this._options=e}return Object.defineProperty(e.prototype,"event",{get:function(){var t=this;return this._event||(this._event=function(r,i,o){var s;return t._callbacks||(t._callbacks=new n),t._options&&t._options.onFirstListenerAdd&&t._callbacks.isEmpty()&&t._options.onFirstListenerAdd(t),t._callbacks.add(r,i),s={dispose:function(){t._callbacks.remove(r,i),s.dispose=e._noop,t._options&&t._options.onLastListenerRemove&&t._callbacks.isEmpty()&&t._options.onLastListenerRemove(t)}},Array.isArray(o)&&o.push(s),s}),this._event},enumerable:!0,configurable:!0}),e.prototype.fire=function(e){this._callbacks&&this._callbacks.invoke.call(this._callbacks,e)},e.prototype.dispose=function(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)},e._noop=function(){},e}();t.Emitter=i},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(27),s=r(25),a=new Buffer("\r","ascii")[0],c=new Buffer("\n","ascii")[0],u=function(){function e(e){void 0===e&&(e="utf8"),this.encoding=e,this.index=0,this.buffer=new Buffer(8192)}return e.prototype.append=function(e){var t=e;if("string"==typeof e){var r=e,n=Buffer.byteLength(r,this.encoding);(t=new Buffer(n)).write(r,0,n,this.encoding)}if(this.buffer.length-this.index>=t.length)t.copy(this.buffer,this.index,0,t.length);else{var i=8192*(Math.ceil((this.index+t.length)/8192)+1);0===this.index?(this.buffer=new Buffer(i),t.copy(this.buffer,0,0,t.length)):this.buffer=Buffer.concat([this.buffer.slice(0,this.index),t],i)}this.index+=t.length},e.prototype.tryReadHeaders=function(){for(var e=void 0,t=0;t+3<this.index&&(this.buffer[t]!==a||this.buffer[t+1]!==c||this.buffer[t+2]!==a||this.buffer[t+3]!==c);)t++;if(t+3>=this.index)return e;e=Object.create(null),this.buffer.toString("ascii",0,t).split("\r\n").forEach((function(t){var r=t.indexOf(":");if(-1===r)throw new Error("Message header must separate key and value using :");var n=t.substr(0,r),i=t.substr(r+1).trim();e[n]=i}));var r=t+4;return this.buffer=this.buffer.slice(r),this.index=this.index-r,e},e.prototype.tryReadContent=function(e){if(this.index<e)return null;var t=this.buffer.toString(this.encoding,0,e),r=e;return this.buffer.copy(this.buffer,0,r),this.index=this.index-r,t},Object.defineProperty(e.prototype,"numberOfBytes",{get:function(){return this.index},enumerable:!0,configurable:!0}),e}();!function(e){e.is=function(e){var t=e;return t&&s.func(t.listen)&&s.func(t.dispose)&&s.func(t.onError)&&s.func(t.onClose)&&s.func(t.onPartialMessage)}}(t.MessageReader||(t.MessageReader={}));var l=function(){function e(){this.errorEmitter=new o.Emitter,this.closeEmitter=new o.Emitter,this.partialMessageEmitter=new o.Emitter}return e.prototype.dispose=function(){this.errorEmitter.dispose(),this.closeEmitter.dispose()},Object.defineProperty(e.prototype,"onError",{get:function(){return this.errorEmitter.event},enumerable:!0,configurable:!0}),e.prototype.fireError=function(e){this.errorEmitter.fire(this.asError(e))},Object.defineProperty(e.prototype,"onClose",{get:function(){return this.closeEmitter.event},enumerable:!0,configurable:!0}),e.prototype.fireClose=function(){this.closeEmitter.fire(void 0)},Object.defineProperty(e.prototype,"onPartialMessage",{get:function(){return this.partialMessageEmitter.event},enumerable:!0,configurable:!0}),e.prototype.firePartialMessage=function(e){this.partialMessageEmitter.fire(e)},e.prototype.asError=function(e){return e instanceof Error?e:new Error("Reader recevied error. Reason: "+(s.string(e.message)?e.message:"unknown"))},e}();t.AbstractMessageReader=l;var f=function(e){function t(t,r){void 0===r&&(r="utf8");var n=e.call(this)||this;return n.readable=t,n.buffer=new u(r),n._partialMessageTimeout=1e4,n}return i(t,e),Object.defineProperty(t.prototype,"partialMessageTimeout",{get:function(){return this._partialMessageTimeout},set:function(e){this._partialMessageTimeout=e},enumerable:!0,configurable:!0}),t.prototype.listen=function(e){var t=this;this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=e,this.readable.on("data",(function(e){t.onData(e)})),this.readable.on("error",(function(e){return t.fireError(e)})),this.readable.on("close",(function(){return t.fireClose()}))},t.prototype.onData=function(e){for(this.buffer.append(e);;){if(-1===this.nextMessageLength){var t=this.buffer.tryReadHeaders();if(!t)return;var r=t["Content-Length"];if(!r)throw new Error("Header must provide a Content-Length property.");var n=parseInt(r);if(isNaN(n))throw new Error("Content-Length value must be a number.");this.nextMessageLength=n}var i=this.buffer.tryReadContent(this.nextMessageLength);if(null===i)return void this.setPartialMessageTimer();this.clearPartialMessageTimer(),this.nextMessageLength=-1,this.messageToken++;var o=JSON.parse(i);this.callback(o)}},t.prototype.clearPartialMessageTimer=function(){this.partialMessageTimer&&(clearTimeout(this.partialMessageTimer),this.partialMessageTimer=void 0)},t.prototype.setPartialMessageTimer=function(){var e=this;this.clearPartialMessageTimer(),this._partialMessageTimeout<=0||(this.partialMessageTimer=setTimeout((function(t,r){e.partialMessageTimer=void 0,t===e.messageToken&&(e.firePartialMessage({messageToken:t,waitingTime:r}),e.setPartialMessageTimer())}),this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))},t}(l);t.StreamMessageReader=f;var d=function(e){function t(t){var r=e.call(this)||this;r.process=t;var n=r.process;return n.on("error",(function(e){return r.fireError(e)})),n.on("close",(function(){return r.fireClose()})),r}return i(t,e),t.prototype.listen=function(e){this.process.on("message",e)},t}(l);t.IPCMessageReader=d;var h=function(e){function t(t,r){return void 0===r&&(r="utf-8"),e.call(this,t,r)||this}return i(t,e),t}(f);t.SocketMessageReader=h},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(27),s=r(25);!function(e){e.is=function(e){var t=e;return t&&s.func(t.dispose)&&s.func(t.onClose)&&s.func(t.onError)&&s.func(t.write)}}(t.MessageWriter||(t.MessageWriter={}));var a=function(){function e(){this.errorEmitter=new o.Emitter,this.closeEmitter=new o.Emitter}return e.prototype.dispose=function(){this.errorEmitter.dispose(),this.closeEmitter.dispose()},Object.defineProperty(e.prototype,"onError",{get:function(){return this.errorEmitter.event},enumerable:!0,configurable:!0}),e.prototype.fireError=function(e,t,r){this.errorEmitter.fire([this.asError(e),t,r])},Object.defineProperty(e.prototype,"onClose",{get:function(){return this.closeEmitter.event},enumerable:!0,configurable:!0}),e.prototype.fireClose=function(){this.closeEmitter.fire(void 0)},e.prototype.asError=function(e){return e instanceof Error?e:new Error("Writer recevied error. Reason: "+(s.string(e.message)?e.message:"unknown"))},e}();t.AbstractMessageWriter=a;var c=function(e){function t(t,r){void 0===r&&(r="utf8");var n=e.call(this)||this;return n.writable=t,n.encoding=r,n.errorCount=0,n.writable.on("error",(function(e){return n.fireError(e)})),n.writable.on("close",(function(){return n.fireClose()})),n}return i(t,e),t.prototype.write=function(e){var t=JSON.stringify(e),r=["Content-Length: ",Buffer.byteLength(t,this.encoding).toString(),"\r\n","\r\n"];try{this.writable.write(r.join(""),"ascii"),this.writable.write(t,this.encoding),this.errorCount=0}catch(t){this.errorCount++,this.fireError(t,e,this.errorCount)}},t}(a);t.StreamMessageWriter=c;var u=function(e){function t(t){var r=e.call(this)||this;r.process=t,r.errorCount=0,r.queue=[],r.sending=!1;var n=r.process;return n.on("error",(function(e){return r.fireError(e)})),n.on("close",(function(){return r.fireClose})),r}return i(t,e),t.prototype.write=function(e){this.sending||0!==this.queue.length?this.queue.push(e):this.doWriteMessage(e)},t.prototype.doWriteMessage=function(e){var t=this;try{this.process.send&&(this.sending=!0,this.process.send(e,void 0,void 0,(function(r){t.sending=!1,r?(t.errorCount++,t.fireError(r,e,t.errorCount)):t.errorCount=0,t.queue.length>0&&t.doWriteMessage(t.queue.shift())})))}catch(t){this.errorCount++,this.fireError(t,e,this.errorCount)}},t}(a);t.IPCMessageWriter=u;var l=function(e){function t(t,r){void 0===r&&(r="utf8");var n=e.call(this)||this;return n.socket=t,n.queue=[],n.sending=!1,n.encoding=r,n.errorCount=0,n.socket.on("error",(function(e){return n.fireError(e)})),n.socket.on("close",(function(){return n.fireClose()})),n}return i(t,e),t.prototype.write=function(e){this.sending||0!==this.queue.length?this.queue.push(e):this.doWriteMessage(e)},t.prototype.doWriteMessage=function(e){var t=this,r=JSON.stringify(e),n=["Content-Length: ",Buffer.byteLength(r,this.encoding).toString(),"\r\n","\r\n"];try{this.sending=!0,this.socket.write(n.join(""),"ascii",(function(n){n&&t.handleError(n,e);try{t.socket.write(r,t.encoding,(function(r){t.sending=!1,r?t.handleError(r,e):t.errorCount=0,t.queue.length>0&&t.doWriteMessage(t.queue.shift())}))}catch(n){t.handleError(n,e)}}))}catch(t){this.handleError(t,e)}},t.prototype.handleError=function(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)},t}(a);t.SocketMessageWriter=l},function(e,t){e.exports=require("net")},function(e,t){e.exports=require("dynamicloader")},,,,,,,,,,,,,,,,,,,,,,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(0),i=r(17),o=r(84),s=r(8),a=r(91),c=r(12);console.log("[Preload] pid: "+process.pid);const{remote:u}=r(10);if(!u.process.argv||u.process.argv.length<2)throw new Error("[Preload] required arguments not specified");const l=c.getStartOptions(u.process.argv[2]),f=r(61),d=f.load(l.slimCorePath),h=n.join(l.slimCorePath,"lib/video-renderer"),p=f.load(h);console.log("[Preload] videoRenderer: "+p),console.log("[Preload] JsonRPC IPC PipeName: "+l.ipcPipeName);const v=l.isHost;console.log("[Preload] isHost: "+v);const g=l.isScreenShareEnabled;console.log("[Preload] isScreenShareEnabled: "+g);const m=l.isScreenShareControlEnabled;console.log("[Preload] isScreenShareControlEnabled: "+m);const y=new a.ConsoleTraceListener;s.defaultTraceSource.addTraceListener(y),window.TraceSource=s.defaultTraceSource,window.SlimCore=d,window.Enums=d.Enums,window.VideoRenderer=p,window.StartOptions=l;const b=new o.JsonRPC(l.ipcPipeName,s.defaultTraceSource),T=new i.AppEvents(b);window.appEvents=T,console.log("[Preload] Completed")},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new r((function(t){t(e.value)})).then(s,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const i=r(85),o=r(6),s=r(60),a=r(17),c=r(8),u=r(7);t.JsonRPC=class{constructor(e,t,r=!1){this.trace=t,this.serverMode=r,this.logPrefix="[JsonRPC]",this.connectionRegistrationQueue=[],this.serverMode?this.setupServer(e):this.setupClient(e)}get isDisposed(){return this.disposed}sendNotification(e){return n(this,void 0,void 0,(function*(){if(this.connection)try{const t=new i.NotificationType(e.eventType);return yield this.connection.sendNotification(t,e)}catch(e){if(!this.disposed)throw this.trace.error(`${this.logPrefix} sendNotification failed: ${e}`),e}}))}sendRequest(e){return n(this,void 0,void 0,(function*(){if(this.connection)try{const t=new i.RequestType(e.eventType);return yield this.connection.sendRequest(t,e)}catch(e){if(!this.disposed)throw this.trace.error(`${this.logPrefix} sendRequest failed: ${e}`),e}}))}on(e,t){this.connection?this.registerEvent(e,t):this.connectionRegistrationQueue.push({eventType:e,func:t})}dispose(){if(this.trace.error(this.logPrefix+" Dispose start"),!this.disposed&&(this.disposed=!0,this.connection&&(this.connection.dispose(),this.connection=null),this.socket&&(this.socket.destroy(),this.socket=null),this.connectionRegistrationQueue=[],!this.serverMode)){this.trace.error(this.logPrefix+" Dispose quit Electron");const{ipcRenderer:e}=r(10);e.send(u.ElectronChannels.quit)}this.trace.error(this.logPrefix+" Dispose end")}isNotificationType(e){return a.NotificationType[e]}setupClient(e){const t=this.getPipePath(e);this.socket=s.createConnection(t),this.socket.on("connect",()=>{this.trace.info(this.logPrefix+" socket connected")}),this.socket.on("error",e=>{const t=`${this.logPrefix} socket error: ${e}`;this.logAndDispose(t)}),this.socket.on("close",()=>{const e=this.logPrefix+" socket closed";this.logAndDispose(e)}),this.connection=i.createMessageConnection(new i.StreamMessageReader(this.socket),new i.StreamMessageWriter(this.socket)),this.initialize()}logAndDispose(e){this.trace.info(e),this.dispose()}initialize(){for(const e of this.connectionRegistrationQueue)this.registerEvent(e.eventType,e.func);this.connectionRegistrationQueue=[],this.connection.onError(e=>{const t=e[0],r=`${this.logPrefix} RPC connection failure with error: ${t}`;this.logAndDispose(r)}),this.connection.onUnhandledNotification(e=>{this.trace.info(`${this.logPrefix} RPC unhandled notification: ${e.method}`)}),this.connection.onDispose(()=>{const e=this.logPrefix+" RPC connection disposed";this.logAndDispose(e)}),this.connection.onClose(()=>{const e=this.logPrefix+" RPC connection closed";this.logAndDispose(e)}),this.connection.listen()}registerEvent(e,t){if(this.isNotificationType(e)){this.trace.info(`${this.logPrefix} Register NotificationType: ${e}`);const r=new i.NotificationType(e);this.connection.onNotification(r,t)}else{this.trace.info(`${this.logPrefix} Register EventType:${e}`);const r=new i.RequestType(e);this.connection.onRequest(r,t)}}setupServer(e){const t=s.createServer(function(e){this.connection=i.createMessageConnection(new i.StreamMessageReader(e),new i.StreamMessageWriter(e)),this.initialize(),e.on("connect",()=>{this.trace.info(this.logPrefix+" stream connected")}),e.on("end",()=>{this.trace.info(this.logPrefix+"  stream ended"),t.close()}),e.on("error",e=>{this.trace.error(`${this.logPrefix} stream error: ${e}`)}),e.on("data",e=>{const t=""+e;this.trace.info(`${this.logPrefix} stream data: ${c.TraceFormat.formatMessage(t,this.trace)}`)}),e.on("event",e=>{this.trace.info(`${this.logPrefix} stream event: ${e}`)})}.bind(this)),r=this.getPipePath(e);t.listen(r)}getPipePath(e){return"win32"===process.platform?"\\\\.\\pipe\\"+e:`${o.tmpdir()}/LiveShareAudio_${e}`}}},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function o(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0});var s=r(25),a=r(86);t.RequestType=a.RequestType,t.RequestType0=a.RequestType0,t.RequestType1=a.RequestType1,t.RequestType2=a.RequestType2,t.RequestType3=a.RequestType3,t.RequestType4=a.RequestType4,t.RequestType5=a.RequestType5,t.RequestType6=a.RequestType6,t.RequestType7=a.RequestType7,t.RequestType8=a.RequestType8,t.RequestType9=a.RequestType9,t.ResponseError=a.ResponseError,t.ErrorCodes=a.ErrorCodes,t.NotificationType=a.NotificationType,t.NotificationType0=a.NotificationType0,t.NotificationType1=a.NotificationType1,t.NotificationType2=a.NotificationType2,t.NotificationType3=a.NotificationType3,t.NotificationType4=a.NotificationType4,t.NotificationType5=a.NotificationType5,t.NotificationType6=a.NotificationType6,t.NotificationType7=a.NotificationType7,t.NotificationType8=a.NotificationType8,t.NotificationType9=a.NotificationType9;var c=r(58);t.MessageReader=c.MessageReader,t.StreamMessageReader=c.StreamMessageReader,t.IPCMessageReader=c.IPCMessageReader,t.SocketMessageReader=c.SocketMessageReader;var u=r(59);t.MessageWriter=u.MessageWriter,t.StreamMessageWriter=u.StreamMessageWriter,t.IPCMessageWriter=u.IPCMessageWriter,t.SocketMessageWriter=u.SocketMessageWriter;var l=r(27);t.Disposable=l.Disposable,t.Event=l.Event,t.Emitter=l.Emitter;var f=r(87);t.CancellationTokenSource=f.CancellationTokenSource,t.CancellationToken=f.CancellationToken;var d,h,p,v,g,m=r(88);o(r(89)),o(r(90)),function(e){e.type=new a.NotificationType("$/cancelRequest")}(d||(d={})),t.NullLogger=Object.freeze({error:function(){},warn:function(){},info:function(){},log:function(){}}),function(e){e[e.Off=0]="Off",e[e.Messages=1]="Messages",e[e.Verbose=2]="Verbose"}(h=t.Trace||(t.Trace={})),function(e){e.fromString=function(t){switch(t=t.toLowerCase()){case"off":return e.Off;case"messages":return e.Messages;case"verbose":return e.Verbose;default:return e.Off}},e.toString=function(t){switch(t){case e.Off:return"off";case e.Messages:return"messages";case e.Verbose:return"verbose";default:return"off"}}}(h=t.Trace||(t.Trace={})),function(e){e.type=new a.NotificationType("$/setTraceNotification")}(p=t.SetTraceNotification||(t.SetTraceNotification={})),function(e){e.type=new a.NotificationType("$/logTraceNotification")}(v=t.LogTraceNotification||(t.LogTraceNotification={})),function(e){e[e.Closed=1]="Closed",e[e.Disposed=2]="Disposed",e[e.AlreadyListening=3]="AlreadyListening"}(g=t.ConnectionErrors||(t.ConnectionErrors={}));var y,b=function(e){function t(r,n){var i=e.call(this,n)||this;return i.code=r,Object.setPrototypeOf(i,t.prototype),i}return i(t,e),t}(Error);function T(e,t,r,n){var i,o,c=0,u=0,T=0,w=void 0,C=Object.create(null),E=void 0,_=Object.create(null),S=new m.LinkedMap,M=Object.create(null),P=Object.create(null),R=h.Off,N=y.New,O=new l.Emitter,k=new l.Emitter,A=new l.Emitter,j=new l.Emitter;function x(e){return"req-"+e.toString()}function q(e,t){var r;a.isRequestMessage(t)?e.set(x(t.id),t):a.isResponseMessage(t)?e.set(null===(r=t.id)?"res-unknown-"+(++T).toString():"res-"+r.toString(),t):e.set("not-"+(++u).toString(),t)}function D(e){}function I(){return N===y.Listening}function L(){return N===y.Closed}function W(){return N===y.Disposed}function U(){N!==y.New&&N!==y.Listening||(N=y.Closed,k.fire(void 0))}function z(){i||0===S.size||(i=setImmediate((function(){i=void 0,function(){if(0===S.size)return;var e=S.shift();try{a.isRequestMessage(e)?function(e){if(W())return;function r(r,n,i){var o={jsonrpc:"2.0",id:e.id};r instanceof a.ResponseError?o.error=r.toJson():o.result=void 0===r?null:r,V(o,n,i),t.write(o)}function n(r,n,i){var o={jsonrpc:"2.0",id:e.id,error:r.toJson()};V(o,n,i),t.write(o)}!function(e){if(R===h.Off||!o)return;var t=void 0;R===h.Verbose&&e.params&&(t="Params: "+JSON.stringify(e.params,null,4)+"\n\n");o.log("Received request '"+e.method+" - ("+e.id+")'.",t)}(e);var i,c,u=C[e.method];u&&(i=u.type,c=u.handler);var l=Date.now();if(c||w){var d=new f.CancellationTokenSource,p=String(e.id);P[p]=d;try{var v=void 0,g=v=void 0===e.params||void 0!==i&&0===i.numberOfParams?c?c(d.token):w(e.method,d.token):s.array(e.params)&&(void 0===i||i.numberOfParams>1)?c?c.apply(void 0,e.params.concat([d.token])):w.apply(void 0,[e.method].concat(e.params,[d.token])):c?c(e.params,d.token):w(e.method,e.params,d.token);v?g.then?g.then((function(t){delete P[p],r(t,e.method,l)}),(function(t){delete P[p],t instanceof a.ResponseError?n(t,e.method,l):t&&s.string(t.message)?n(new a.ResponseError(a.ErrorCodes.InternalError,"Request "+e.method+" failed with message: "+t.message),e.method,l):n(new a.ResponseError(a.ErrorCodes.InternalError,"Request "+e.method+" failed unexpectedly without providing any details."),e.method,l)})):(delete P[p],r(v,e.method,l)):(delete P[p],function(r,n,i){void 0===r&&(r=null);var o={jsonrpc:"2.0",id:e.id,result:r};V(o,n,i),t.write(o)}(v,e.method,l))}catch(t){delete P[p],t instanceof a.ResponseError?r(t,e.method,l):t&&s.string(t.message)?n(new a.ResponseError(a.ErrorCodes.InternalError,"Request "+e.method+" failed with message: "+t.message),e.method,l):n(new a.ResponseError(a.ErrorCodes.InternalError,"Request "+e.method+" failed unexpectedly without providing any details."),e.method,l)}}else n(new a.ResponseError(a.ErrorCodes.MethodNotFound,"Unhandled method "+e.method),e.method,l)}(e):a.isNotificationMessage(e)?function(e){if(W())return;var t,n=void 0;if(e.method===d.type.method)t=function(e){var t=e.id,r=P[String(t)];r&&r.cancel()};else{var i=_[e.method];i&&(t=i.handler,n=i.type)}if(t||E)try{!function(e){if(R===h.Off||!o||e.method===v.type.method)return;var t=void 0;R===h.Verbose&&(t=e.params?"Params: "+JSON.stringify(e.params,null,4)+"\n\n":"No parameters provided.\n\n");o.log("Received notification '"+e.method+"'.",t)}(e),void 0===e.params||void 0!==n&&0===n.numberOfParams?t?t():E(e.method):s.array(e.params)&&(void 0===n||n.numberOfParams>1)?t?t.apply(void 0,e.params):E.apply(void 0,[e.method].concat(e.params)):t?t(e.params):E(e.method,e.params)}catch(t){t.message?r.error("Notification handler '"+e.method+"' failed with message: "+t.message):r.error("Notification handler '"+e.method+"' failed unexpectedly.")}else A.fire(e)}(e):a.isResponseMessage(e)?function(e){if(W())return;if(null===e.id)e.error?r.error("Received response message without id: Error is: \n"+JSON.stringify(e.error,void 0,4)):r.error("Received response message without id. No further error information provided.");else{var t=String(e.id),n=M[t];if(function(e,t){if(R===h.Off||!o)return;var r=void 0;R===h.Verbose&&(e.error&&e.error.data?r="Error data: "+JSON.stringify(e.error.data,null,4)+"\n\n":e.result?r="Result: "+JSON.stringify(e.result,null,4)+"\n\n":void 0===e.error&&(r="No result returned.\n\n"));if(t){var n=e.error?" Request failed: "+e.error.message+" ("+e.error.code+").":"";o.log("Received response '"+t.method+" - ("+e.id+")' in "+(Date.now()-t.timerStart)+"ms."+n,r)}else o.log("Received response "+e.id+" without active response promise.",r)}(e,n),n){delete M[t];try{if(e.error){var i=e.error;n.reject(new a.ResponseError(i.code,i.message,i.data))}else{if(void 0===e.result)throw new Error("Should never happen.");n.resolve(e.result)}}catch(i){i.message?r.error("Response handler '"+n.method+"' failed with message: "+i.message):r.error("Response handler '"+n.method+"' failed unexpectedly.")}}}}(e):function(e){if(!e)return void r.error("Received empty message.");r.error("Received message which is neither a response nor a notification message:\n"+JSON.stringify(e,null,4));var t=e;if(s.string(t.id)||s.number(t.id)){var n=String(t.id),i=M[n];i&&i.reject(new Error("The received response has neither a result nor an error property."))}}(e)}finally{z()}}()})))}e.onClose(U),e.onError((function(e){O.fire([e,void 0,void 0])})),t.onClose(U),t.onError((function(e){O.fire(e)}));var J=function(e){try{if(a.isNotificationMessage(e)&&e.method===d.type.method){var r=x(e.params.id),i=S.get(r);if(a.isRequestMessage(i)){var o=n&&n.cancelUndispatched?n.cancelUndispatched(i,D):void 0;if(o&&(void 0!==o.error||void 0!==o.result))return S.delete(r),o.id=i.id,V(o,e.method,Date.now()),void t.write(o)}}q(S,e)}finally{z()}};function H(e){if(R!==h.Off&&o){var t=void 0;R===h.Verbose&&e.params&&(t="Params: "+JSON.stringify(e.params,null,4)+"\n\n"),o.log("Sending request '"+e.method+" - ("+e.id+")'.",t)}}function $(e){if(R!==h.Off&&o){var t=void 0;R===h.Verbose&&(t=e.params?"Params: "+JSON.stringify(e.params,null,4)+"\n\n":"No parameters provided.\n\n"),o.log("Sending notification '"+e.method+"'.",t)}}function V(e,t,r){if(R!==h.Off&&o){var n=void 0;R===h.Verbose&&(e.error&&e.error.data?n="Error data: "+JSON.stringify(e.error.data,null,4)+"\n\n":e.result?n="Result: "+JSON.stringify(e.result,null,4)+"\n\n":void 0===e.error&&(n="No result returned.\n\n")),o.log("Sending response '"+t+" - ("+e.id+")'. Processing request took "+(Date.now()-r)+"ms",n)}}function F(){if(L())throw new b(g.Closed,"Connection is closed.");if(W())throw new b(g.Disposed,"Connection is disposed.")}function B(){if(!I())throw new Error("Call listen() first.")}function Q(e){return void 0===e?null:e}function G(e,t){var r,n=e.numberOfParams;switch(n){case 0:r=null;break;case 1:r=Q(t[0]);break;default:r=[];for(var i=0;i<t.length&&i<n;i++)r.push(Q(t[i]));if(t.length<n)for(i=t.length;i<n;i++)r.push(null)}return r}var Y={sendNotification:function(e){for(var r,n,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];if(F(),s.string(e))switch(r=e,i.length){case 0:n=null;break;case 1:n=i[0];break;default:n=i}else r=e.method,n=G(e,i);var a={jsonrpc:"2.0",method:r,params:n};$(a),t.write(a)},onNotification:function(e,t){F(),s.func(e)?E=e:t&&(s.string(e)?_[e]={type:void 0,handler:t}:_[e.method]={type:e,handler:t})},sendRequest:function(e){for(var r,n,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];F(),B();var u=void 0;if(s.string(e))switch(r=e,i.length){case 0:n=null;break;case 1:f.CancellationToken.is(i[0])?(n=null,u=i[0]):n=Q(i[0]);break;default:var l=i.length-1;f.CancellationToken.is(i[l])?(u=i[l],n=2===i.length?Q(i[0]):i.slice(0,l).map((function(e){return Q(e)}))):n=i.map((function(e){return Q(e)}))}else{r=e.method,n=G(e,i);var h=e.numberOfParams;u=f.CancellationToken.is(i[h])?i[h]:void 0}var p=c++,v=new Promise((function(e,i){var o={jsonrpc:"2.0",id:p,method:r,params:n},s={method:r,timerStart:Date.now(),resolve:e,reject:i};H(o);try{t.write(o)}catch(e){s.reject(new a.ResponseError(a.ErrorCodes.MessageWriteError,e.message?e.message:"Unknown reason")),s=null}s&&(M[String(p)]=s)}));return u&&u.onCancellationRequested((function(){Y.sendNotification(d.type,{id:p})})),v},onRequest:function(e,t){F(),s.func(e)?w=e:t&&(s.string(e)?C[e]={type:void 0,handler:t}:C[e.method]={type:e,handler:t})},trace:function(e,t,r){void 0===r&&(r=!1),o=(R=e)===h.Off?void 0:t,!r||L()||W()||Y.sendNotification(p.type,{value:h.toString(e)})},onError:O.event,onClose:k.event,onUnhandledNotification:A.event,onDispose:j.event,dispose:function(){if(!W()){N=y.Disposed,j.fire(void 0);var r=new Error("Connection got disposed.");Object.keys(M).forEach((function(e){M[e].reject(r)})),M=Object.create(null),P=Object.create(null),S=new m.LinkedMap,s.func(t.dispose)&&t.dispose(),s.func(e.dispose)&&e.dispose()}},listen:function(){F(),function(){if(I())throw new b(g.AlreadyListening,"Connection is already listening")}(),N=y.Listening,e.listen(J)},inspect:function(){console.log("inspect")}};return Y.onNotification(v.type,(function(e){R!==h.Off&&o&&o.log(e.message,R===h.Verbose?e.verbose:void 0)})),Y}t.ConnectionError=b,function(e){e.is=function(e){var t=e;return t&&s.func(t.cancelUndispatched)}}(t.ConnectionStrategy||(t.ConnectionStrategy={})),function(e){e[e.New=1]="New",e[e.Listening=2]="Listening",e[e.Closed=3]="Closed",e[e.Disposed=4]="Disposed"}(y||(y={})),t.createMessageConnection=function(e,r,n,i){var o;return n||(n=t.NullLogger),T(void 0!==(o=e).listen&&void 0===o.read?e:new c.StreamMessageReader(e),function(e){return void 0!==e.write&&void 0===e.end}(r)?r:new u.StreamMessageWriter(r),n,i)}},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o,s=r(25);!function(e){e.ParseError=-32700,e.InvalidRequest=-32600,e.MethodNotFound=-32601,e.InvalidParams=-32602,e.InternalError=-32603,e.serverErrorStart=-32099,e.serverErrorEnd=-32e3,e.ServerNotInitialized=-32002,e.UnknownErrorCode=-32001,e.RequestCancelled=-32800,e.MessageWriteError=1,e.MessageReadError=2}(o=t.ErrorCodes||(t.ErrorCodes={}));var a=function(e){function t(r,n,i){var a=e.call(this,n)||this;return a.code=s.number(r)?r:o.UnknownErrorCode,a.data=i,Object.setPrototypeOf(a,t.prototype),a}return i(t,e),t.prototype.toJson=function(){return{code:this.code,message:this.message,data:this.data}},t}(Error);t.ResponseError=a;var c=function(){function e(e,t){this._method=e,this._numberOfParams=t}return Object.defineProperty(e.prototype,"method",{get:function(){return this._method},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numberOfParams",{get:function(){return this._numberOfParams},enumerable:!0,configurable:!0}),e}();t.AbstractMessageType=c;var u=function(e){function t(t){var r=e.call(this,t,0)||this;return r._=void 0,r}return i(t,e),t}(c);t.RequestType0=u;var l=function(e){function t(t){var r=e.call(this,t,1)||this;return r._=void 0,r}return i(t,e),t}(c);t.RequestType=l;var f=function(e){function t(t){var r=e.call(this,t,1)||this;return r._=void 0,r}return i(t,e),t}(c);t.RequestType1=f;var d=function(e){function t(t){var r=e.call(this,t,2)||this;return r._=void 0,r}return i(t,e),t}(c);t.RequestType2=d;var h=function(e){function t(t){var r=e.call(this,t,3)||this;return r._=void 0,r}return i(t,e),t}(c);t.RequestType3=h;var p=function(e){function t(t){var r=e.call(this,t,4)||this;return r._=void 0,r}return i(t,e),t}(c);t.RequestType4=p;var v=function(e){function t(t){var r=e.call(this,t,5)||this;return r._=void 0,r}return i(t,e),t}(c);t.RequestType5=v;var g=function(e){function t(t){var r=e.call(this,t,6)||this;return r._=void 0,r}return i(t,e),t}(c);t.RequestType6=g;var m=function(e){function t(t){var r=e.call(this,t,7)||this;return r._=void 0,r}return i(t,e),t}(c);t.RequestType7=m;var y=function(e){function t(t){var r=e.call(this,t,8)||this;return r._=void 0,r}return i(t,e),t}(c);t.RequestType8=y;var b=function(e){function t(t){var r=e.call(this,t,9)||this;return r._=void 0,r}return i(t,e),t}(c);t.RequestType9=b;var T=function(e){function t(t){var r=e.call(this,t,1)||this;return r._=void 0,r}return i(t,e),t}(c);t.NotificationType=T;var w=function(e){function t(t){var r=e.call(this,t,0)||this;return r._=void 0,r}return i(t,e),t}(c);t.NotificationType0=w;var C=function(e){function t(t){var r=e.call(this,t,1)||this;return r._=void 0,r}return i(t,e),t}(c);t.NotificationType1=C;var E=function(e){function t(t){var r=e.call(this,t,2)||this;return r._=void 0,r}return i(t,e),t}(c);t.NotificationType2=E;var _=function(e){function t(t){var r=e.call(this,t,3)||this;return r._=void 0,r}return i(t,e),t}(c);t.NotificationType3=_;var S=function(e){function t(t){var r=e.call(this,t,4)||this;return r._=void 0,r}return i(t,e),t}(c);t.NotificationType4=S;var M=function(e){function t(t){var r=e.call(this,t,5)||this;return r._=void 0,r}return i(t,e),t}(c);t.NotificationType5=M;var P=function(e){function t(t){var r=e.call(this,t,6)||this;return r._=void 0,r}return i(t,e),t}(c);t.NotificationType6=P;var R=function(e){function t(t){var r=e.call(this,t,7)||this;return r._=void 0,r}return i(t,e),t}(c);t.NotificationType7=R;var N=function(e){function t(t){var r=e.call(this,t,8)||this;return r._=void 0,r}return i(t,e),t}(c);t.NotificationType8=N;var O=function(e){function t(t){var r=e.call(this,t,9)||this;return r._=void 0,r}return i(t,e),t}(c);t.NotificationType9=O,t.isRequestMessage=function(e){var t=e;return t&&s.string(t.method)&&(s.string(t.id)||s.number(t.id))},t.isNotificationMessage=function(e){var t=e;return t&&s.string(t.method)&&void 0===e.id},t.isResponseMessage=function(e){var t=e;return t&&(void 0!==t.result||!!t.error)&&(s.string(t.id)||s.number(t.id)||null===t.id)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=r(27),o=r(25);!function(e){e.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:i.Event.None}),e.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:i.Event.None}),e.is=function(t){var r=t;return r&&(r===e.None||r===e.Cancelled||o.boolean(r.isCancellationRequested)&&!!r.onCancellationRequested)}}(n=t.CancellationToken||(t.CancellationToken={}));var s=Object.freeze((function(e,t){var r=setTimeout(e.bind(t),0);return{dispose:function(){clearTimeout(r)}}})),a=function(){function e(){this._isCancelled=!1}return e.prototype.cancel=function(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this._emitter=void 0))},Object.defineProperty(e.prototype,"isCancellationRequested",{get:function(){return this._isCancelled},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onCancellationRequested",{get:function(){return this._isCancelled?s:(this._emitter||(this._emitter=new i.Emitter),this._emitter.event)},enumerable:!0,configurable:!0}),e}(),c=function(){function e(){}return Object.defineProperty(e.prototype,"token",{get:function(){return this._token||(this._token=new a),this._token},enumerable:!0,configurable:!0}),e.prototype.cancel=function(){this._token?this._token.cancel():this._token=n.Cancelled},e.prototype.dispose=function(){this.cancel()},e}();t.CancellationTokenSource=c},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.None=0,e.First=1,e.Last=2}(n=t.Touch||(t.Touch={}));var i=function(){function e(){this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0}return e.prototype.clear=function(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0},e.prototype.isEmpty=function(){return!this._head&&!this._tail},Object.defineProperty(e.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this._map.has(e)},e.prototype.get=function(e){var t=this._map.get(e);if(t)return t.value},e.prototype.set=function(e,t,r){void 0===r&&(r=n.None);var i=this._map.get(e);if(i)i.value=t,r!==n.None&&this.touch(i,r);else{switch(i={key:e,value:t,next:void 0,previous:void 0},r){case n.None:this.addItemLast(i);break;case n.First:this.addItemFirst(i);break;case n.Last:default:this.addItemLast(i)}this._map.set(e,i),this._size++}},e.prototype.delete=function(e){var t=this._map.get(e);return!!t&&(this._map.delete(e),this.removeItem(t),this._size--,!0)},e.prototype.shift=function(){if(this._head||this._tail){if(!this._head||!this._tail)throw new Error("Invalid list");var e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}},e.prototype.forEach=function(e,t){for(var r=this._head;r;)t?e.bind(t)(r.value,r.key,this):e(r.value,r.key,this),r=r.next},e.prototype.forEachReverse=function(e,t){for(var r=this._tail;r;)t?e.bind(t)(r.value,r.key,this):e(r.value,r.key,this),r=r.previous},e.prototype.values=function(){for(var e=[],t=this._head;t;)e.push(t.value),t=t.next;return e},e.prototype.keys=function(){for(var e=[],t=this._head;t;)e.push(t.key),t=t.next;return e},e.prototype.addItemFirst=function(e){if(this._head||this._tail){if(!this._head)throw new Error("Invalid list");e.next=this._head,this._head.previous=e}else this._tail=e;this._head=e},e.prototype.addItemLast=function(e){if(this._head||this._tail){if(!this._tail)throw new Error("Invalid list");e.previous=this._tail,this._tail.next=e}else this._head=e;this._tail=e},e.prototype.removeItem=function(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head)this._head=e.next;else if(e===this._tail)this._tail=e.previous;else{var t=e.next,r=e.previous;if(!t||!r)throw new Error("Invalid list");t.previous=r,r.next=t}},e.prototype.touch=function(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(t===n.First||t===n.Last)if(t===n.First){if(e===this._head)return;var r=e.next,i=e.previous;e===this._tail?(i.next=void 0,this._tail=i):(r.previous=i,i.next=r),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e}else if(t===n.Last){if(e===this._tail)return;r=e.next,i=e.previous;e===this._head?(r.previous=void 0,this._head=r):(r.previous=i,i.next=r),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e}},e}();t.LinkedMap=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(6),o=r(9),s=r(60),a=r(58),c=r(59);t.generateRandomPipeName=function(){var e=o.randomBytes(21).toString("hex");return"win32"===process.platform?"\\\\.\\pipe\\vscode-jsonrpc-"+e+"-sock":n.join(i.tmpdir(),"vscode-"+e+".sock")},t.createClientPipeTransport=function(e,t){var r;void 0===t&&(t="utf-8");var n=new Promise((function(e,t){r=e}));return new Promise((function(i,o){var u=s.createServer((function(e){u.close(),r([new a.SocketMessageReader(e,t),new c.SocketMessageWriter(e,t)])}));u.on("error",o),u.listen(e,(function(){u.removeListener("error",o),i({onConnected:function(){return n}})}))}))},t.createServerPipeTransport=function(e,t){void 0===t&&(t="utf-8");var r=s.createConnection(e);return[new a.SocketMessageReader(r,t),new c.SocketMessageWriter(r,t)]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(60),i=r(58),o=r(59);t.createClientSocketTransport=function(e,t){var r;void 0===t&&(t="utf-8");var s=new Promise((function(e,t){r=e}));return new Promise((function(a,c){var u=n.createServer((function(e){u.close(),r([new i.SocketMessageReader(e,t),new o.SocketMessageWriter(e,t)])}));u.on("error",c),u.listen(e,"127.0.0.1",(function(){u.removeListener("error",c),a({onConnected:function(){return s}})}))}))},t.createServerSocketTransport=function(e,t){void 0===t&&(t="utf-8");var r=n.createConnection(e,"127.0.0.1");return[new i.SocketMessageReader(r,t),new o.SocketMessageWriter(r,t)]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(8);class i extends n.TraceListener{constructor(){super()}writeLine(e){}writeEvent(e,t,r,i){switch(t){case n.TraceEventType.Error:console.error(i);break;case n.TraceEventType.Warning:console.warn(i);break;case n.TraceEventType.Information:default:console.log(i)}}}t.ConsoleTraceListener=i}]);
//# sourceMappingURL=preload.js.map